Return-Path: <linux-can-owner@vger.kernel.org>
X-Original-To: lists+linux-can@lfdr.de
Delivered-To: lists+linux-can@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 613BF671D15
	for <lists+linux-can@lfdr.de>; Wed, 18 Jan 2023 14:09:16 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S229988AbjARNJO (ORCPT <rfc822;lists+linux-can@lfdr.de>);
        Wed, 18 Jan 2023 08:09:14 -0500
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:38710 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S230316AbjARNIs (ORCPT
        <rfc822;linux-can@vger.kernel.org>); Wed, 18 Jan 2023 08:08:48 -0500
Received: from DEU01-BE0-obe.outbound.protection.outlook.com (mail-be0deu01on2049.outbound.protection.outlook.com [40.107.127.49])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 74C5A53FA2
        for <linux-can@vger.kernel.org>; Wed, 18 Jan 2023 04:32:18 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=hq6+foI5hpKPsTO0tgd2Y7t7CXWmerxRFlKxwsqOAlW64pQQMj6FHZ3JpvErcvBd46KRj566QXY1cIYbU7zWtnPnY4p6xZ1R/ej3IiznOHEgjYLYTnrhroAhrAag70vCFXx/5mIcOKrJNpbmnQlhLcZ7Q6bKgRrjhoYMpW9QuO+vsl6NcY3yzA8NUfeN/GDsmgal8peSgPU4fale9JQKAMvv/tDvDuQuMmi05cr2A2yWiXeSPPXNKRQFpU2fqGOui/2MQ7n0k/ETnZY4UJKPKQ7JVHeV8HXuGbTqB7UxNSI3Zz5al4mvphj9t8MIR8yB/m0cOBHIYRwXIb/UELaq/Q==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=Ux1iB0MdTjyL5z3OnXuYi/aw74PFiqn7fnipigDRWH0=;
 b=lEukWg5seUxOQAFosH1a/eB9tokaNPySVydJJjPF0yFXloUr/kPXaVFxJ7Dw1D7os0hO/mOLDbBzqGEl52SlJisV039tdiBBrJGr0ulu7jLkPbCDwdWPmg9e9I3igFVZTdOd/fqoYx+k7+lrn51OyoP7K2gh4q4nW6fGRSW1b9dFaLdH4B/bhyReu1EV5wnvkfOj52eVfzwTyb8A2vmzfXWtyGCwyxYDUHtmGHkqyvNxYnETPnDq/G2jtE8tcRCKs0l05mHVMrtzDO3RNS3VRKOITSb3dgLK97+6KJYs00jpKklUsfBk3HtJIKJPN4FnuBGlnJeSAMd+o/Ym9UfyaA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=janztec.com; dmarc=pass action=none header.from=janztec.com;
 dkim=pass header.d=janztec.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=janzag.onmicrosoft.de;
 s=selector1-janzag-onmicrosoft-de;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Ux1iB0MdTjyL5z3OnXuYi/aw74PFiqn7fnipigDRWH0=;
 b=YAJH8sbKDcNcIbwgPc7TDhr5LjUtaGx66B9P+3bu880OQftp3kTrgrJ8WSQ4uYIAPjhQ08/Kw6BJRM+H0cx5dDMe2Fc+ojtAhNHvtl4eI+SKev/YhJME4qN5PzhcT4iD4z2aZSd4C3G/1nkCbv7W2NF0qr9w/Bq+I0Dtht1u5c8=
Received: from FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM (2603:10a6:d10:26::13)
 by FR2P281MB2895.DEUP281.PROD.OUTLOOK.COM (2603:10a6:d10:68::10) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6002.24; Wed, 18 Jan
 2023 12:32:15 +0000
Received: from FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM
 ([fe80::d76a:8be5:c810:d1ba]) by FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM
 ([fe80::d76a:8be5:c810:d1ba%7]) with mapi id 15.20.6002.012; Wed, 18 Jan 2023
 12:32:15 +0000
From:   =?iso-8859-1?Q?Stefan_Alth=F6fer?= <Stefan.Althoefer@janztec.com>
To:     "linux-can@vger.kernel.org" <linux-can@vger.kernel.org>
Subject: WG: mcp251xfd: rx frame truncation (1/2)
Thread-Topic: mcp251xfd: rx frame truncation (1/2)
Thread-Index: AQHZKzjliniR2Rjet0qunKK2mAziBw==
Date:   Wed, 18 Jan 2023 12:32:15 +0000
Message-ID: <FR0P281MB1966F32AD422DDD867F8C53A97C79@FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM>
References: <FR0P281MB1966C774C1ED0752CCD6B80497C79@FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM>
In-Reply-To: <FR0P281MB1966C774C1ED0752CCD6B80497C79@FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM>
Accept-Language: de-DE, en-US
Content-Language: de-DE
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=janztec.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: FR0P281MB1966:EE_|FR2P281MB2895:EE_
x-ms-office365-filtering-correlation-id: 3985e27f-8960-40e1-69e1-08daf95007fc
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: AsjDdsl8y/wTBXQrC11QLfdTG1VsjwqGgs9MwsqbAmWagi+BghpzQS7DjhV86o+MNBuOXZnmEeu9okFLIR4qRfqufKecL6/g7JjVXxJKvdXC8Bxjsr8T5RnkaIh60YxrokPnuDvPPystJW2rOWnNSi7Hlz8bjpMz58FFVjF31fqqZ3L/X1hpLGLfS+ev6AaKaVN5ZcSfGfcgDOlIdgjuDase0C65iu3FsbTrjlkxRMa1f7CD5odX/wX6g+VEkjEHlFsqpHKpKoBQTbkyhJ7zych3e9iD5bYSyBAukBBBZjJvFFI+F7S6xytbpY5H/SePahNQYKSk65fedXkAveVkLOB1Zvn65Pe/E+R1kwIGIoJ4VRltdYBfBGWgI3xNntnSHUHaLC4feLxWehLKuMTC3PylGDc2/f/rSsejNB4MjSdWRv4pF6UhnsBadcd7A0yB0Y0C1QODbox9/Ppad3Uq4mEJn7o+QRr6gU1Yx2WWHILnIDWZ+3BWa86Db8ELn8YyQTVUfJACDo1Tq5JuMdc0DWCCb5iVfDMVMCeEhkw4QmlRexjiGpHRPU5ZyF2jNXwOXrdHQdtnGuZEeS/dOK49HHsrKKZzzZcecSJXxI1l2zowlQ0mxvXQdWQ+M52lYsiM9OnXn1oeieaZgB5q/JKkNRMLiaR/XOMryXxvJnMhOMXSwYlpA9dyVQZcGfzxBQspgataS5aU+RA6O8u2abWuCQ==
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM;PTR:;CAT:NONE;SFS:(13230022)(4636009)(39830400003)(396003)(136003)(346002)(376002)(366004)(451199015)(122000001)(99936003)(38100700002)(38070700005)(33656002)(8936002)(66476007)(5660300002)(52536014)(66946007)(2906002)(55016003)(76116006)(66556008)(66446008)(64756008)(8676002)(6916009)(41300700001)(26005)(9686003)(186003)(83380400001)(2940100002)(66574015)(7696005)(71200400001)(86362001)(478600001)(316002)(6506007);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?iso-8859-1?Q?kaHO7fRIO0qNef8Yll7yIQ3F7cuLUmB3ndc563DzLJUSRupiBGb9FQ9+l3?=
 =?iso-8859-1?Q?dXtcOQuFbTkMq6EOG+LKB0xnByepbvLT7wMlY/8NVXKB9xrLBFWqohzt/U?=
 =?iso-8859-1?Q?dZiQ9K3vZys/Y7OE1LJ8wqEIl8Vjkl8KVvAEYfb3ZWGlDJkavbWDDMvCsQ?=
 =?iso-8859-1?Q?VL/EpWZTxKWOnaaCrsfY9sOEZL0kVEwKb9Z65c+v4GTRLIlP1vPYBh8T9x?=
 =?iso-8859-1?Q?qBvBIdFH8G5UtospjjvkvbbocxOPSlm6aytbUXGwiUcb76qNYcB/1GdMXm?=
 =?iso-8859-1?Q?PxdcrpeNer5c51k6b6YoOnSiz2NK/ArpZ4rosuv1NMh3s62ybWsHJZnFRR?=
 =?iso-8859-1?Q?8mNIqC0xg8TK1CQ/jPUJj5A/uWGLt1DGmUQWoEWOEdLTlxthNIM7TAbyjw?=
 =?iso-8859-1?Q?uJ6jG1/nAmLKAvX0O4W2kHR/MCRIlDQj72QipXP7J8y9gGnXBc3wk0w9d3?=
 =?iso-8859-1?Q?qpI6E/bnLwiXKXHurgXBmvhvzwFkCIx5JPstwUcDB370g/23Ac4pu1VT4Q?=
 =?iso-8859-1?Q?zN8QUpIFyiHWUh/HF7PzacJNFd7LhZVvtN5dkMwpLhOb236DovnGLxVrRl?=
 =?iso-8859-1?Q?tsnhfzosjsQTIijQQn/q5J2U1lWU04sTAdZlNdhWrZWeE8cMFpkUYlQu1X?=
 =?iso-8859-1?Q?/y5gXNqhb+XPgE3M4+WKQC10/gHcPQaYg8cP7pwpQGDHqWd3/d39/UkwDV?=
 =?iso-8859-1?Q?B03rCb0nhYVtW5Detv+SD5XPEaFzYhI5FOwR4MRLe7LJlc/NQVIQhJfKD/?=
 =?iso-8859-1?Q?cLuiNWYCz0uFL5kTODg/bEvy+JV8TC7NH2BGLJ5VdRjd00hXzlqu9fusxK?=
 =?iso-8859-1?Q?DBLEuYGDvW3vcv/orpEddO4yJEwj52JWgibIusVuOHoztjk4uK3VLvYfaA?=
 =?iso-8859-1?Q?T4jK6VjfYIbryLNAMNKYZBWiDAmpLgcv5tV3oasRwv9xw1RjAfJESvmWzo?=
 =?iso-8859-1?Q?UP6NiI1gwAMzPes0DxrYfc7V1cRrYqc0yM+T/SpYCAgaq0i4tbl2Fja9Jg?=
 =?iso-8859-1?Q?pZpycyT/MCnGNYjKyWxvBgSrZrnpAd1YZDyXIvi0k0nqtLRB3KR19KuMcl?=
 =?iso-8859-1?Q?iBhiaONWxqvBTm/slizJNJ7fDKXzhlibjlN7ZGZquXtL9TU8I6yHNDFO24?=
 =?iso-8859-1?Q?0IiXO7y3fCrYYZ/3Z50SBB4XjEYx5IheRCcQI7ikE7/M9UZmAPNh1QZKrc?=
 =?iso-8859-1?Q?J/q6R5Ji0LAB4dGk70cOsfH839vPcXXGSF/00krYLiJKUT7JHSweKefLb6?=
 =?iso-8859-1?Q?AHuhpP8fk/4MZVToLwVxynkteSksCfBzP/8JpiHKRKbPviEJcL86VPggmh?=
 =?iso-8859-1?Q?V4o43snz1gpPKeRh18LDWTXkwjPX7anSepOtEFEbvYbaKrn7NDXX4X++NM?=
 =?iso-8859-1?Q?94NpUoeED04La9RzrQbSVqatFcRk1zuKOEIlFwuDTu1OsHny2Cu9iuHmiL?=
 =?iso-8859-1?Q?2qdJh+23qYIdiQ6wKEOR4zqTEMf45U0MgnDP8e9hHCdL/wWlPbtw+Z+XdT?=
 =?iso-8859-1?Q?zvg2XkveZymzQy/y0J3RctmzZw4+Vx/zkJ8tBxN8CXCfOwKiVE32rICoqi?=
 =?iso-8859-1?Q?5CElYJ3BrwkRFii17s4MW5kNfBKKB5S3gMyUIujwasvp7YS7U0IZh7YcqP?=
 =?iso-8859-1?Q?ue60u9SvnKvyenORQPxndQT2/k/XltmUxiKtCrahtHsTgA1YgsOHU4LA?=
 =?iso-8859-1?Q?=3D=3D?=
Content-Type: multipart/mixed;
        boundary="_002_FR0P281MB1966F32AD422DDD867F8C53A97C79FR0P281MB1966DEUP_"
MIME-Version: 1.0
X-OriginatorOrg: janztec.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: FR0P281MB1966.DEUP281.PROD.OUTLOOK.COM
X-MS-Exchange-CrossTenant-Network-Message-Id: 3985e27f-8960-40e1-69e1-08daf95007fc
X-MS-Exchange-CrossTenant-originalarrivaltime: 18 Jan 2023 12:32:15.2404
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: c1dae847-7bcf-493f-b143-af65743cbb23
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 1caRYQgQFJVsf0rLeg3g02DrFxTko0K3h9gPSfbO8rKeitRrROb8PI/kPga9mRaMMM5OrRqMwgU7VjentrDGxsHzZoWW0uD6wxMHF9jAv3U=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: FR2P281MB2895
X-Spam-Status: No, score=-1.9 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,RCVD_IN_DNSWL_NONE,RCVD_IN_MSPIKE_H2,SPF_HELO_PASS,SPF_PASS
        autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-can.vger.kernel.org>
X-Mailing-List: linux-can@vger.kernel.org

--_002_FR0P281MB1966F32AD422DDD867F8C53A97C79FR0P281MB1966DEUP_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Send again as the original post was to long

-----Urspr=FCngliche Nachricht-----
Von: Stefan Alth=F6fer=20
Gesendet: Mittwoch, 18. Januar 2023 12:27
An: linux-can@vger.kernel.org
Cc: Marc Kleine-Budde <mkl@pengutronix.de>
Betreff: mcp251xfd: rx frame truncation

While still testing the double-RX erratum patch I'm experiencing another pr=
oblem.

I'm using my setup with two mcp2518fd and my own 'sctest' program. Both are=
 sending  messages to each other. I start sending a number of transmit ahea=
d frames and then  send out one more messages when a frame arrives at the p=
eer.=20
So  overrun should not occur.

In contrast to the tests I did over the weekend, I increased the transmit a=
head to 3, sending now up to 64 bytes and the frame size is now random.

I now frequently see these kind of messages appear:

Jan 18 05:34:00 raspberrypi kernel: [405471.116322] mcp251xfd spi0.0 can0: =
Transmit Event FIFO buffer not empty. (seq=3D0x00001e36, tef_tail=3D0x00001=
e3a, tef_head=3D0x00001e3b, tx_head=3D0x00001e3b).
Jan 18 09:36:27 raspberrypi kernel: [420017.452369] mcp251xfd spi6.0 can1: =
Transmit Event FIFO buffer full. (seq=3D0x00001062, tef_tail=3D0x00001066, =
tef_head=3D0x00001067, tx_head=3D0x00001067).

Why do they occur?

But now the real problem. After some time one of the socketcans is receivin=
g only a truncated message:

1: idx    2 exp:2A5#00 02 F4 7C 7B F2 53 BD 53 84 B3 4B B7 5F AE 55 2D 88 1=
3 25 7C D4 82 EF 85 35 9C 33 1B 7C 5B 55 91 4F D1 0D 41 24 CA 95 A9 7E E0 6=
0 DD 8E B5 0A 16 C8 2F 92 9C B1 82 22 E6 1E 55 01 9A B0 56 2B
1:           rx:2A5#00 02 F4 7C 7B F2 53 BD 53 84 B3 4B B7 5F AE 55 2D 88 1=
3 25

Same reception in the candump1 log (candump -H -td -D canX,0:0,#FFFFFFFF).=
=20
However the message was Transmitted correctly, as the external logger has r=
eceived it.

47:36.412.753      +0.172   0677fd  64  00 02 f4 7c 7b f2 53 bd  53 84 b3 4=
b b7 5f ae 55  2d 88 13 25 7c d4 82 ef  85 35 9c 33 1b 7c 5b 55  91 4f d1 0=
d 41 24 ca 95  a9 7e e0 60 dd 8e b5 0a  16 c8 2f 92 9c b1 82 22  e6 1e 55 0=
1 9a b0 56 2b

I attached the regdump at the time when the test loop finished. At least al=
l data bytes seem to be in the RAM.

I attached the 'sctest' source. It should build in the same environment as =
'sctestself'.

I've seen this truncation occurring several times.

I think the problem did not occur when transmit ahead was set to 2, but I r=
e-run the test again right now to verify.

Ask if you want more information!

-----
Stefan Alth=F6fer (stefan.althoefer@janztec.com)

--_002_FR0P281MB1966F32AD422DDD867F8C53A97C79FR0P281MB1966DEUP_
Content-Type: text/plain; name="sctest.c"
Content-Description: sctest.c
Content-Disposition: attachment; filename="sctest.c"; size=36098;
	creation-date="Wed, 18 Jan 2023 10:41:16 GMT";
	modification-date="Wed, 18 Jan 2023 12:32:15 GMT"
Content-Transfer-Encoding: base64

LyogLSotQy0qLQogKiBzY3Rlc3QuYyAtIFJhdyBzb2NrZXRjYW4gdGVzdCBwcm9ncmFtICgyIG5v
ZGUgcngvdHggdGVzdCkKICoKICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKgogKiAgICAgICAgICAgICAgICAg
ICBDb3B5cmlnaHQgKGMpIDIwMjMgSmFueiBUZWMgQUcKICogICAgICAgICAgICAgICAgICAgICAg
ICBBbGwgUmlnaHRzIFJlc2VydmVkCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQg
dG8gbGljZW5zZWVzIG9mIEphbnogVGVjIEFHCiAqIHByb2R1Y3RzIHRvIHVzZSBvciBhYnN0cmFj
dCB0aGlzIGNvbXB1dGVyIHByb2dyYW0gZm9yIHRoZSBzb2xlCiAqIHB1cnBvc2Ugb2YgaW1wbGVt
ZW50aW5nIGEgcHJvZHVjdCBiYXNlZCBvbiBKYW56IFRlYyBBRwogKiBwcm9kdWN0cy4gICBObyBv
dGhlciByaWdodHMgdG8gcmVwcm9kdWNlLCB1c2UsIG9yIGRpc3NlbWluYXRlCiAqIHRoaXMgY29t
cHV0ZXIgcHJvZ3JhbSwgd2hldGhlciBpbiBwYXJ0IG9yIGluIHdob2xlLCBhcmUgZ3JhbnRlZC4K
ICoKICogSmFueiBUZWMgQUcgbWFrZXMgbm8gcmVwcmVzZW50YXRpb24gb3Igd2FycmFudGllcwog
KiB3aXRoIHJlc3BlY3QgdG8gdGhlIHBlcmZvcm1hbmNlIG9mIHRoaXMgY29tcHV0ZXIgcHJvZ3Jh
bSwgYW5kCiAqIHNwZWNpZmljYWxseSBkaXNjbGFpbXMgYW55IHJlc3BvbnNpYmlsaXR5IGZvciBh
bnkgZGFtYWdlcywgc3BlY2lhbAogKiBvciBjb25zZXF1ZW50aWFsLCBjb25uZWN0ZWQgd2l0aCB0
aGUgdXNlIG9mIHRoaXMgcHJvZ3JhbS4KICoKICogSmFueiBUZWMgQUcgcHJvZHVjdHMgYXJlIG5v
dCBhdXRob3JpemVkIGZvciB1c2UgYXMKICogY3JpdGljYWwgY29tcG9uZW50cyBpbiBsaWZlIHN1
cHBvcnQgZGV2aWNlcyBvciBzeXN0ZW1zIHdpdGhvdXQgdGhlCiAqIGV4cHJlc3Mgd3JpdHRlbiBh
cHByb3ZhbCBvZiBKYW56IFRlYyBBRy4KICoKICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKgogKiAkSWQ6IHNj
dGVzdC5jIDQwMjAgMjAyMy0wMS0xNyAyMjowOToyNFogYXMgJAogKgogKi0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CiAqLwoKCi8qKioqKiBpbmNsdWRlcyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRl
IDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgoKI2luY2x1ZGUgPG5ldC9pZi5oPgojaW5j
bHVkZSA8c3lzL3NvY2tldC5oPgojaW5jbHVkZSA8c3lzL2lvY3RsLmg+CiNpbmNsdWRlIDxzeXMv
c29ja2V0Lmg+CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KI2luY2x1ZGUgPHRpbWUuaD4KI2luY2x1
ZGUgPGZjbnRsLmg+CiNpbmNsdWRlIDxzeXMvdGltZS5oPgojaW5jbHVkZSA8c3lzL3RpbWVzLmg+
CiNpbmNsdWRlIDx1bmlzdGQuaD4KI2luY2x1ZGUgPGVycm5vLmg+CiNpbmNsdWRlIDxzY2hlZC5o
PgojaW5jbHVkZSA8c3lzL21tYW4uaD4KI2luY2x1ZGUgPHNpZ25hbC5oPgoKI2luY2x1ZGUgPG5l
dGluZXQvaW4uaD4KI2luY2x1ZGUgPG5ldGRiLmg+CgojaW5jbHVkZSA8bGludXgvY2FuLmg+CiNp
bmNsdWRlIDxsaW51eC9jYW4vcmF3Lmg+CiNpbmNsdWRlIDxsaW51eC9jYW4vZXJyb3IuaD4KCiNp
bmNsdWRlICJzdm5nbGJyZXYuaCIKI2luY2x1ZGUgImpsaWIuaCIKI2luY2x1ZGUgImxpYnNvY2tl
dGNhbi5oIgoKCi8qKioqKiBkZWZpbmVzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKI2RlZmluZSBDVF9SQVdfVElNRU9VVCAg
ICAgICAxCiNkZWZpbmUgQ1RfUkFXX0JBRF9SRUNFSVZFICAgMgojZGVmaW5lIENUX1JBV19OT19S
RVNQT05TRSAgIDMKI2RlZmluZSBDVF9SQVdfQlVTX0VSUk9SUyAgICA0CiNkZWZpbmUgQ1RfUkFX
X1JFQURfRVJST1IgICAgNQojZGVmaW5lIENUX1JBV19CQURfT1JERVIgICAgIDYKI2RlZmluZSBD
VF9SQVdfRFVQTElDQVRFUyAgICA3CiNkZWZpbmUgQ1RfUkFXX1RFUk1JTkFURUQgICA5OQoKI2Rl
ZmluZSBNQVhGUEFUSCA1MTIKCiNkZWZpbmUgTUFYUEtUTlVNICAgMTAwMAojZGVmaW5lIERGTFRQ
S1ROVU0gICAgODAKI2RlZmluZSBNQVhMT09QUyAgIDEwMDAwCiNkZWZpbmUgREZMVExPT1BTICAg
ICAyNQojZGVmaW5lIERGTFRUWEFIRUFEICAgIDQKI2RlZmluZSBERkxUVElNRU9VVCAgIDIwIAoj
ZGVmaW5lIERGTFRJRCAgICAgICAgMHgyYTUgCgojZGVmaW5lIEZMQUdTX05PUkFORE9NREFUQSAg
ICAweDAwMQojZGVmaW5lIEZMQUdTX1JBTkRPTUlaRSAgICAgICAweDAwMgojZGVmaW5lIEZMQUdT
X1JFRklMTERBVEEgICAgICAweDAwNAojZGVmaW5lIEZMQUdTX0FMTE9XT09PRCAgICAgICAweDAx
MCAgICAvKiBPdXQtT2YtT3JkZXItRGVsaXZlcnkgKi8KI2RlZmluZSBGTEFHU19MRVNTRE9UUyAg
ICAgICAgMHgxMDAKI2RlZmluZSBGTEFHU19MRUFTVERPVFMgICAgICAgMHgyMDAKI2RlZmluZSBG
TEFHU19TVE9QT05FUlJPUiAgICAgMHg0MDAKCiNkZWZpbmUgVkVSQl9TVEFUUyAgICAgIDB4MDAx
CiNkZWZpbmUgVkVSQl9JRlBST1AgICAgIDB4MDAyCiNkZWZpbmUgVkVSQl9USU1FUlIgICAgIDB4
MTAwCiNkZWZpbmUgVkVSQl9DTVBFUlIgICAgIDB4MjAwCiNkZWZpbmUgVkVSQl9MT0dNU0cgICAg
IDB4NDAwCiNkZWZpbmUgVkVSQl9MT1NTRVJSICAgIDB4ODAwCgojZGVmaW5lIHZwcmludGYobGV2
ZWwsIGZvcm1hdCwgLi4uKSBkbyB7ICAgICAgICBcCiAgICBpZihsZXZlbCAmIG9wdF92ZXJib3Nl
KSAgICAgICAgICAgICAgICAgICAgIFwKICAgICAgICBmcHJpbnRmKHN0ZG91dCwgZm9ybWF0LCAj
I19fVkFfQVJHU19fKTsgXAp9IHdoaWxlKDApCgoKLyoqKioqIHR5cGVkZWZzICoqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgpzdHJ1
Y3QgY2FudGVzdF9yYXcgewogICAgaW50ICAgICBzdGF0dXM7ICAgICAgLyogMD1vaywgMT1mYWls
ICovCiAgICBkb3VibGUgIGRUOyAgICAgICAgICAvKiBpbiBzZWNvbmRzICovCiAgICBkb3VibGUg
IHNwZWVkOyAgICAgICAvKiBpbiBrYml0L3MgKi8KICAgIGludCAgICAgbG9zczsgICAgICAgIC8q
IG1lc3NhZ2VzIGxvc3QgKi8KICAgIGludCAgICAgYmVycmNudDsgICAgIC8qIGJ1cyBlcnJvciBj
b3VudCAqLwp9IGNhbnRlc3RfcmF3OwoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgICB1c1RpbWVyX3Q7
CgoKLyoqKioqIGltcG9ydHMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKiovCgoKLyoqKioqIGxvY2FscyAqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgoKLyoqKioq
IGdsb2JhbHMgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKiovCgppbnQgICAgIG9wdF92ZXJib3NlOwpjaGFyICAgICpvcHRfY2FuZGV2
WzJdOwppbnQgICAgIG9wdF9ydDsKaW50ICAgICBvcHRfcGt0czsKaW50ICAgICBvcHRfbG9vcHM7
CnVuc2lnbmVkIGludCBvcHRfbGRlbGF5OwppbnQgICAgIG9wdF90aW1lb3V0OwppbnQgICAgIG9w
dF9hbGxvd2VycjsKaW50ICAgICBvcHRfdHhhaGVhZDsKaW50ICAgICBvcHRfZmxhZ3M7CmludCAg
ICAgb3B0X3Rlcm07CmludCAgICAgb3B0X2lkOwppbnQgICAgIG9wdF9kbGVuOwppbnQgICAgIG9w
dF9lZmY7CmludCAgICAgb3B0X2JyczsKaW50ICAgICBvcHRfdHhkZXZudW07CmNoYXIgICAgKm9w
dF9sb2dnZXI7CmNoYXIgICAgKm9wdF9zZW5kOwoKaW50ICAgICBzb2NrZmRbMl07CmludCAgICAg
Y2FuX210dVsyXTsgIC8qIE1UVSBvZiBlYWNoIGNoYW5uZWwgKi8KaW50ICAgICBjbXBfbXR1OyAg
ICAgLyogbGVhc3QgTVRVIG9mIGJvdGggY2hhbm5lbCAqLwoKc3RydWN0IGNhbmZkX2ZyYW1lICB0
eGRhdGFbMl1bTUFYUEtUTlVNKzEwMF07IC8qIG1lc3NhZ2Ugb3V0IGJ1ZiAqLwpzdHJ1Y3QgY2Fu
ZmRfZnJhbWUgIHJ4ZGF0YVsyXVtNQVhQS1ROVU0rMTAwXTsgLyogbWVzc2FnZSBpbiBidWYgKi8K
aW50ICAgICAgICAgICAgICAgICByeGlkeGNudFsyXVtNQVhQS1ROVU0rMTAwXTsgLyogY291bnQg
ZWFjaCByeCBpbmRleCAqLwoKdm9sYXRpbGUgaW50ICAgIGh1cDsKdm9sYXRpbGUgaW50ICAgIHNp
Z2ludDsKCgojZGVmaW5lIERCR19MT0dfTUFYICAgICAgNDE5NgojZGVmaW5lIERCR19MT0dfVFgg
ICAgICAgMAojZGVmaW5lIERCR19MT0dfUlggICAgICAgMQoKaW50ICAgICAgICAgICAgICAgICAg
ZGJnX2xvZ19wb3M7CgpzdHJ1Y3QgZGJnX2xvZ19idWZmIHsKICAgIGludCAgICAgY2g7CiAgICBp
bnQgICAgIGRpcjsKICAgIGludCAgICAgdHhjbnQ7CiAgICBpbnQgICAgIHJ4Y250OwogICAgc3Ry
dWN0IGNhbmZkX2ZyYW1lIGZyYW1lOwp9IGRiZ19sb2dfYnVmZltEQkdfTE9HX01BWF07CgoKLyoq
KioqIGZvcndhcmQgZGVjbGFyYXRpb25zICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKiovCgpzdGF0aWMgaW50IGNsZWFudXAoaW50IHJldHZhbCk7CgoKLyoK
ICogbG9nZ2VyOiAgICAgICAgICAgPGhvc3Q+Ojxwb3J0bm8+ICAgICAoaW1wbGVtZW50ZWQpCiAq
ICAgICAgICAgIFs8dHlwZT5AXTxob3N0Pjo8cG9ydG5vPiAgICAgKG5vdCB5ZXQgaW1wbGVtZW50
ZWQpCiAqLwppbnQgcmVhZExvZ2dlcigKICAgIGNoYXIgICAgICAgKmxvZ2dlciwKICAgIGludCAg
ICAgICAgbXNnY250CikKewogICAgc3RydWN0IGhvc3RlbnQgICAgICAgICpoaW07CiAgICBzdHJ1
Y3Qgc29ja2FkZHJfaW4gICAgc2luOwogICAgaW50CSAgICAgICAgICAgICAgICAgIGZkOwogICAg
Y2hhciAgICAgICAgICAgICAgICAgIGluYnVmZlsxMDI0XTsKICAgIGNoYXIgICAgICAgICAgICAg
ICAgICBjbWRidWZmWzY0XTsKICAgIGludCAgICAgICAgICAgICAgICAgICBuOwogICAgc3RydWN0
IHRpbWV2YWwgICAgICAgIHRpbWVvdXQ7CiAgICBjaGFyICAgICAgICAgICAgICAgICAgaG9zdFs2
NF07CiAgICBpbnQgICAgICAgICAgICAgICAgICAgcG9ydDsKCiAgICBob3N0WzBdID0gJ1wwJzsK
ICAgIHBvcnQgPSAwOwogICAgaWYoIHNzY2FuZihsb2dnZXIsICIlNjNbXjpdOiVkIiwgaG9zdCwg
JnBvcnQpICE9IDIgKXsKCWZwcmludGYoc3RkZXJyLCAicmVhZExvZ2dlcigpOiB3cm9uZyBsb2dn
ZXIgcGFyYW1ldGVyOiBmb3VuZCAlczolZFxuIiwgaG9zdCwgcG9ydCk7CglyZXR1cm4gLTE7CiAg
ICB9CiAgICAKICAgIGlmICgoZmQgPSBzb2NrZXQoQUZfSU5FVCwgU09DS19TVFJFQU0sIDApKSA8
IDApIHsKCWZwcmludGYoc3RkZXJyLCAicmVhZExvZ2dlcigpOiBzb2NrZXQoKSBmYWlsZWRcbiIp
OwoJcmV0dXJuIC0xOwogICAgfQogICAgCiAgICBiemVybygoY2hhciopJnNpbixzaXplb2Yoc2lu
KSk7CiAgICAKICAgIGlmICgoaGltID0gZ2V0aG9zdGJ5bmFtZShob3N0KSkgPT0gTlVMTCkgewoJ
ZnByaW50ZihzdGRlcnIsICJyZWFkTG9nZ2VyKCk6IFVua25vd24gaG9zdCAlc1xuIiwgaG9zdCk7
CglyZXR1cm4gLTI7CiAgICB9CiAgICBiY29weShoaW0tPmhfYWRkciwgKGNhZGRyX3QpJnNpbi5z
aW5fYWRkciwgaGltLT5oX2xlbmd0aCk7CiAgICBzaW4uc2luX2ZhbWlseSA9IGhpbS0+aF9hZGRy
dHlwZTsgICAgICAKCiAgICBzaW4uc2luX3BvcnQgPSBodG9ucyhwb3J0KTsKCiAgICBpZiAoY29u
bmVjdChmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZzaW4sIHNpemVvZihzaW4pKSA8IDApIHsKCWZw
cmludGYoc3RkZXJyLCAicmVhZExvZ2dlcigpOiBjYW5ub3QgY29ubmVjdCgpXG4iKTsKCWNsb3Nl
KGZkKTsKCXJldHVybiAtMzsKICAgIH0KCiAgICB0aW1lb3V0LnR2X3NlYyA9IDA7CiAgICB0aW1l
b3V0LnR2X3VzZWMgPSAxMDAqMTAwMDsKICAgIGlmKCBzZXRzb2Nrb3B0KGZkLCBTT0xfU09DS0VU
LCBTT19SQ1ZUSU1FTywKCQkgICAmdGltZW91dCxzaXplb2YodGltZW91dCkpIDwgMCApCiAgICB7
CglmcHJpbnRmKHN0ZGVyciwgInJlYWRMb2dnZXIoKTogY2Fubm90IHNldCBSQ1ZUSU1FT1VUXG4i
KTsKCXJldHVybiAtMjsKICAgIH0KCiAgICAvKiBSZXF1ZXN0IGRhdGEgZnJvbSBwZWVyICovCiAg
ICBzcHJpbnRmKGNtZGJ1ZmYsImljczolZHNcclxuIiwgbXNnY250KTsKICAgIGlmKCB3cml0ZShm
ZCwgY21kYnVmZiwgc3RybGVuKGNtZGJ1ZmYpKSA8IDAgKXsKCXJldHVybiAtNDsKICAgIH0KCiAg
ICAvKiBGSVhNRTogdGhlIGRhdGEgb24gdGhlIHNvY2tldCBpcyBzZW50IHdpdGggQ1JOTCBsaW5l
IGVuZGluZy4KICAgICAgIFdlIGRvbnQgY29udmVydCB0byBOTC1vbmx5IGVuZGluZywgYW5kIGp1
c3QgcHJpbnQgdGhlIENScwogICAgICAgYWxvbmcgd2l0aCB0aGUgTkxzLiAqLwogICAgd2hpbGUo
IDEgKXsKCW4gPSByZWFkKGZkLCBpbmJ1ZmYsIDEwMjMpOwoJaWYoIG4gPD0gMCApewoJICAgIHBy
aW50ZigiZG9uZSAoJWQpXG4iLCBuKTsKCSAgICBicmVhazsKCX0KCWluYnVmZltuXSA9ICdcMCc7
CglwcmludGYoIiVzIiwgaW5idWZmKTsKICAgIH0KCiAgICBjbG9zZShmZCk7CiAgICAKICAgIHJl
dHVybiAwOwp9CgoKdm9pZCBkYmdfbG9nKAogICAgaW50ICAgICAgICAgICAgICAgICBjaCwKICAg
IGludCAgICAgICAgICAgICAgICAgZGlyLAogICAgaW50ICAgICAgICAgICAgICAgICB0eGNudCwK
ICAgIGludCAgICAgICAgICAgICAgICAgcnhjbnQsCiAgICBzdHJ1Y3QgY2FuZmRfZnJhbWUgICpm
cmFtZQopCnsKICAgIGRiZ19sb2dfYnVmZltkYmdfbG9nX3Bvc10uY2ggPSBjaDsKICAgIGRiZ19s
b2dfYnVmZltkYmdfbG9nX3Bvc10uZGlyID0gZGlyOwogICAgZGJnX2xvZ19idWZmW2RiZ19sb2df
cG9zXS50eGNudCA9IHR4Y250OwogICAgZGJnX2xvZ19idWZmW2RiZ19sb2dfcG9zXS5yeGNudCA9
IHJ4Y250OwogICAgbWVtY3B5KCYoZGJnX2xvZ19idWZmW2RiZ19sb2dfcG9zXS5mcmFtZSksIGZy
YW1lLCBzaXplb2Yoc3RydWN0IGNhbmZkX2ZyYW1lKSk7CiAgICBkYmdfbG9nX3BvcysrOwogICAg
aWYoIGRiZ19sb2dfcG9zID49IERCR19MT0dfTUFYICl7CglkYmdfbG9nX3BvcyA9IDA7CiAgICB9
Cn0KCnZvaWQgZGJnX2xvZ19wcmludCh2b2lkKQp7CiAgICBpbnQgICBpOwogICAgaW50ICAgbG9n
Y250OwogICAgCiAgICAvKiBwcmludCBpbiByZXZlcnNlIG9yZGVyICovCiAgICBkYmdfbG9nX3Bv
cy0tOwogICAgaWYoIGRiZ19sb2dfcG9zIDwgMCApewoJZGJnX2xvZ19wb3MgPSBEQkdfTE9HX01B
WC0xOwogICAgfQoKICAgIGxvZ2NudCA9IG9wdF9wa3RzICogNTsKICAgIGlmKCBsb2djbnQgPiA0
MDAwICl7Cglsb2djbnQgPSA0MDAwOwogICAgfQogICAgCiAgICBmb3IoaT0wOyBpPGxvZ2NudDsg
aSsrKXsKCXByaW50ZigiJWQ6ICVzICglLjNkLyUuM2QpICAiLAoJICAgICAgIGRiZ19sb2dfYnVm
ZltkYmdfbG9nX3Bvc10uY2gsCgkgICAgICAgZGJnX2xvZ19idWZmW2RiZ19sb2dfcG9zXS5kaXIg
PyAiUlgiOiAiVFgiICwKCSAgICAgICBkYmdfbG9nX2J1ZmZbZGJnX2xvZ19wb3NdLnR4Y250LAoJ
ICAgICAgIGRiZ19sb2dfYnVmZltkYmdfbG9nX3Bvc10ucnhjbnQpOwoJZnByaW50X2NhbmZyYW1l
X210dShzdGRvdXQgLCAmKGRiZ19sb2dfYnVmZltkYmdfbG9nX3Bvc10uZnJhbWUpLCAiXG4iLCAx
LAoJCQkgICAgc2l6ZW9mKHN0cnVjdCBjYW5mZF9mcmFtZSkpOwoJZGJnX2xvZ19wb3MtLTsKCWlm
KCBkYmdfbG9nX3BvcyA8IDAgKXsKCSAgICBkYmdfbG9nX3BvcyA9IERCR19MT0dfTUFYLTE7Cgl9
CiAgICB9Cn0KCgp1c1RpbWVyX3QgdXNUaW1lcigKICAgIHVzVGltZXJfdCAgICAgIHJlZmVyZW5j
ZQopCnsKICAgIHN0cnVjdCB0aW1ldmFsICAgdHY7CiAgICBzdHJ1Y3QgdGltZXpvbmUgIHR6Owog
ICAgaW50ICAgICAgICAgICAgICB4OwogICAgCiAgICBnZXR0aW1lb2ZkYXkoJnR2LCAmdHopOwog
ICAgeCA9ICh0di50dl9zZWMlMTAwKSoxMDAwMDAwICsgdHYudHZfdXNlYzsKICAgIC8qIHByaW50
Zigic2VjPSV1LCB1cz0ldSwgeD0ldSAgIC0tIiwgKHR2LnR2X3NlYyUxMCksIHR2LnR2X3VzZWMs
IHgpOyAqLwogICAgCiAgICBpZiggcmVmZXJlbmNlICE9IDAgKXsKCWlmKCB4ID49IHJlZmVyZW5j
ZSApewoJICAgIHJldHVybiAoeC1yZWZlcmVuY2UpOwoJfSBlbHNlIHsKCSAgICByZXR1cm4gKDEw
MCoxMDAwMDAwLXJlZmVyZW5jZSt4KTsKCX0KICAgIH0KICAgIAogICAgcmV0dXJuIHg7Cn0KCi8q
ZXJyb3IgLSB3cmFwcGVyIGZvciBwZXJyb3IgKi8Kdm9pZCBlcnJvcigKICAgIGNoYXIgKm1zZwop
CnsKICBwZXJyb3IobXNnKTsKICBleGl0KDEyNik7Cn0KCnZvaWQgc2V0X2h1cCgKICAgIGludCBz
aWdubwopCnsKICAgIGh1cCA9IDE7CiAgICBpZiggc2lnbm8gPT0gU0lHSU5UICl7CglzaWdpbnQg
PSAxOwogICAgfQp9CgppbnQgdGVzdGxvb3AoCiAgICBpbnQgICBzb2NrZmRbMl0sCiAgICBpbnQg
ICBwa3RudW0KKQp7CiAgICBpbnQgICAgICAgdHhudW07CiAgICBpbnQgICAgICAgbjsKICAgIGlu
dCAgICAgICBsb29wY250ID0gMDsKICAgIGludCAgICAgICB0eGNudFsyXTsKICAgIGludCAgICAg
ICByeGNudFsyXTsKICAgIGludCAgICAgICBnb29kY250WzJdOwogICAgaW50ICAgICAgIGlkeDEg
PSAwOwogICAgaW50ICAgICAgIGRldmlkeDsKICAgIHVzVGltZXJfdCB0MDsKICAgIHN0cnVjdCB0
aW1ldmFsIHRpbWVvdXQ7CiAgICBpbnQgICAgICAgYmVycmNudCA9IDA7CiAgICBpbnQgICAgICAg
b29jbnQgPSAwOwogICAgaW50ICAgICAgIGR1cGNudCA9IDA7CiAgICBmZF9zZXQgICAgcmRmczsK
ICAgIGludCAgICAgICByZXQ7CiAgICBpbnQgICAgICAgZmlyc3RfY21wX2VycjsKICAgIGludCAg
ICAgICB0aGlzcng7CiAgICBpbnQgICAgICAgZXhwcng7CiAgICBpbnQgICAgICAgcmVhZF9lcnJv
ciA9IDA7CgogICAgLyogVW5saW5rIFVEUCwgQ0FOIGlzIHJlbGlhYmxlLiBIZW5jZSB3ZSBkbyBu
b3QgbmVlZCB0byBzZW5kCiAgICAgICBleGVjc3MgcGFja2V0cyB0byBjb21wZW5zYXRlIGxvc3Mg
Ki8KICAgIHR4bnVtID0gcGt0bnVtOwoKICAgIC8qIHNldCBvdXIgc29ja2V0IHdhaXRpbmcgdGlt
ZW91dCAqLwogICAgdGltZW91dC50dl9zZWMgPSAwOwogICAgdGltZW91dC50dl91c2VjID0gb3B0
X3RpbWVvdXQqMTAwMDsKICAgIGZvciggZGV2aWR4PTA7IGRldmlkeDwyOyBkZXZpZHgrKyApewoJ
aWYoIHNldHNvY2tvcHQoc29ja2ZkWzBdLCBTT0xfU09DS0VULCBTT19SQ1ZUSU1FTywKCQkgICAg
ICAgJnRpbWVvdXQsc2l6ZW9mKHRpbWVvdXQpKSA8IDAgKQoJewoJICAgIGVycm9yKCJcbkVycm9y
IGluIHNldHNvY2tvcHQgIik7CgkgICAgZXhpdChjbGVhbnVwKDEpKTsKCX0KCglnb29kY250W2Rl
dmlkeF0gPSAwOwoJdHhjbnRbZGV2aWR4XSA9IDA7CglyeGNudFtkZXZpZHhdID0gMDsKICAgIH0K
CiAgICAvKiBQcmUtZmlsbCAoMHhmZikgYm90aCByZWNlaXZlIGJ1ZmZlcnMgKi8KICAgIG1lbXNl
dChyeGRhdGEsIDB4ZmYsIHNpemVvZihyeGRhdGEpKTsKCiAgICBtZW1zZXQocnhpZHhjbnQsIDAs
IHNpemVvZihyeGlkeGNudCkpOwoKICAgIC8qIHNhbXBsZSB0aW1lICovCiAgICB0MCA9IHVzVGlt
ZXIoMCk7CgogICAgLyogc2VuZCBhaGVhZCBwYWNrZXRzIChvbmx5IG9uIGRldmlkeD0wIHdoZW4g
b3B0X3R4ZGV2bnVtPTEpICovCiAgICBmb3IoIGRldmlkeD0wOyBkZXZpZHg8b3B0X3R4ZGV2bnVt
OyBkZXZpZHgrKyApewoJZm9yKCB0eGNudFtkZXZpZHhdPTA7ICh0eGNudFtkZXZpZHhdPHR4bnVt
KSAmJiAodHhjbnRbZGV2aWR4XTxvcHRfdHhhaGVhZCk7CgkgICAgIHR4Y250W2RldmlkeF0rKyAp
Cgl7CgkgICAgbiA9IHdyaXRlKHNvY2tmZFtkZXZpZHhdLCAodm9pZCAqKSYodHhkYXRhW2Rldmlk
eF1bdHhjbnRbZGV2aWR4XV0pLAoJCSAgICAgIGNhbl9tdHVbZGV2aWR4XSk7CgkgICAgaWYoIG4g
PCBjYW5fbXR1W2RldmlkeF0gKXsKCQlmcHJpbnRmKHN0ZGVyciwgIlxuRVJST1IgaW4gd3JpdGUg
KCVkLCBlcnJubz0lZCkgIiwgbiwgZXJybm8pOwoJCWV4aXQoY2xlYW51cCgxKSk7CgkgICAgfQoJ
ICAgIGlmKCBvcHRfdmVyYm9zZSAmIFZFUkJfTE9HTVNHICl7CgkJZGJnX2xvZyhkZXZpZHgsIERC
R19MT0dfVFgsIHR4Y250W2RldmlkeF0sIHJ4Y250W2RldmlkeF0sIAoJCQkmKHR4ZGF0YVtkZXZp
ZHhdW3R4Y250W2RldmlkeF1dKSk7CgkgICAgfQoJfQogICAgfQoKICAgIHdoaWxlKCAxICl7Cgkv
KiBSZWNlaXZlIG1lc3NhZ2VzOiBPbmx5IG9uIGRldmlkeD0xIHdoZW4gb3B0X3R4ZGV2bnVtPTEg
Ki8KCUZEX1pFUk8oJnJkZnMpOwoJZm9yKGRldmlkeD0ob3B0X3R4ZGV2bnVtPT0yKT8wOjE7IGRl
dmlkeDwyOyBkZXZpZHgrKyl7CgkgICAgRkRfU0VUKHNvY2tmZFtkZXZpZHhdLCAmcmRmcyk7Cgl9
CgoJdGltZW91dC50dl9zZWMgPSAwOwoJdGltZW91dC50dl91c2VjID0gb3B0X3RpbWVvdXQqMTAw
MDsKCWlmKCAocmV0ID0gc2VsZWN0KHNvY2tmZFsxXSsxLCAmcmRmcywgTlVMTCwgTlVMTCwgJnRp
bWVvdXQpKSA8PSAwICl7CgkgICAgLy9mcHJpbnRmKHN0ZGVyciwgIlxuRVJST1Igc2VsZWN0IHRp
bWVkIG91dCAiKTsKCSAgICBnb3RvIGRvbmU7Cgl9CgkKCWZvcihkZXZpZHg9KG9wdF90eGRldm51
bT09Mik/MDoxOyBkZXZpZHg8MjsgZGV2aWR4KyspewoJICAgIGlmKCAhIEZEX0lTU0VUKHNvY2tm
ZFtkZXZpZHhdLCAmcmRmcykpIHsKCQljb250aW51ZTsKCSAgICB9CgoJICAgIG4gPSByZWFkKHNv
Y2tmZFtkZXZpZHhdLCAodm9pZCAqKSYocnhkYXRhW2RldmlkeF1bcnhjbnRbZGV2aWR4XV0pLCBj
YW5fbXR1W2RldmlkeF0pOwoJICAgIGlmKCBvcHRfdmVyYm9zZSAmIFZFUkJfTE9HTVNHICl7CgkJ
ZGJnX2xvZyhkZXZpZHgsIERCR19MT0dfUlgsIHR4Y250W2RldmlkeF0sIHJ4Y250W2RldmlkeF0s
IAoJCQkmKHJ4ZGF0YVtkZXZpZHhdW3J4Y250W2RldmlkeF1dKSk7CgkgICAgfQoKI2lmIDAKCSAg
ICAvKiBTaW11bGF0ZSBtc2cgZXJyb3I6IGNyZWF0ZSBhIGR1cGxpY2F0ZSAqLwoJICAgIGlmKCAo
ZGV2aWR4ID09IDEpICYmIChyeGNudFtkZXZpZHhdID09IDMpICl7CgkJbWVtY3B5KCYocnhkYXRh
W2RldmlkeF1bM10pLCAmKHJ4ZGF0YVtkZXZpZHhdWzMtMl0pLCBzaXplb2Yoc3RydWN0IGNhbmZk
X2ZyYW1lKSk7CgkgICAgfQojZW5kaWYKCgkgICAgdGhpc3J4ICA9IChyeGRhdGFbZGV2aWR4XVty
eGNudFtkZXZpZHhdXS5kYXRhWzBdPDw4KSYweGZmMDA7CgkgICAgdGhpc3J4IHw9IChyeGRhdGFb
ZGV2aWR4XVtyeGNudFtkZXZpZHhdXS5kYXRhWzFdPDwwKSYweDAwZmY7CgkgICAgaWYoIHRoaXNy
eCA8IHR4bnVtICl7CgkJcnhpZHhjbnRbZGV2aWR4XVt0aGlzcnhdKys7CgkgICAgfQoJICAgIAoj
aWYgMAoJICAgIC8qIFNpbXVsYXRlIGRhdGEgZXJyb3I6IHRvZ2dsZSBieXRlIGluIHNlcXVlbmNl
IGNvdW50ICovCgkgICAgaWYoIChkZXZpZHggPT0gMSkgJiYgKHJ4Y250W2RldmlkeF0gPT0gMykg
KXsKCQlwcmludGYoIlNJTSBSWEVSUk9SXG4iKTsKCQlyeGRhdGFbZGV2aWR4XVtyeGNudFtkZXZp
ZHhdXS5kYXRhWzBdIF49IDB4ZmY7CgkgICAgfQoJICAgIC8qIFNpbXVsYXRlIGRhdGEgZXJyb3I6
IHRvZ2dsZSBieXRlIGluIHBheWxvYWQgKi8KCSAgICBpZiggKGRldmlkeCA9PSAxKSAmJiAocnhj
bnRbZGV2aWR4XSA9PSAxOSkgKXsKCQlwcmludGYoIlNJTSBSWEVSUk9SXG4iKTsKCQlyeGRhdGFb
ZGV2aWR4XVtyeGNudFtkZXZpZHhdXS5kYXRhWzJdIF49IDB4ZmY7CgkgICAgfQojZW5kaWYKCgkg
ICAgaWYoIChuID09IGNhbl9tdHVbZGV2aWR4XSkgfHwgKG4gPT0gQ0FOX01UVSkgKXsKCQlpZigg
biA9PSBDQU5fTVRVICl7CgkJICAgIC8qIE5vdGU6IFdlIGRvbnQgY2FyZSBmb3IgdGhlIGZsYWdz
IGZpZWxkIHdoZW4gd2UKCQkgICAgICAgY29tcGFyZSBpbmNvbW1pbmcgZGF0YSwgYnV0IHdlIGRv
bnQgd2FudCByYW5kb20KCQkgICAgICAgZGF0YSBoZXJlICovCgkJICAgIHJ4ZGF0YVtkZXZpZHhd
W3J4Y250W2RldmlkeF1dLmZsYWdzID0gMDsKCQl9CgkJaWYoIHJ4ZGF0YVtkZXZpZHhdW3J4Y250
W2RldmlkeF1dLmNhbl9pZCAmIENBTl9FUlJfRkxBRyApewoJCSAgICBpZiggcnhkYXRhW2Rldmlk
eF1bcnhjbnRbZGV2aWR4XV0uY2FuX2lkICYgQ0FOX0VSUl9CVVNPRkYgKXsKCQkJcHJpbnRmKCJF
b2ZmIik7CgkJICAgIH0gZWxzZSBpZiAoIHJ4ZGF0YVtkZXZpZHhdW3J4Y250W2RldmlkeF1dLmNh
bl9pZCAmIENBTl9FUlJfQUNLICl7CgkJCXByaW50ZigiRWFjayIpOwoJCSAgICB9IGVsc2UgaWYg
KCByeGRhdGFbZGV2aWR4XVtyeGNudFtkZXZpZHhdXS5jYW5faWQgJiBDQU5fRVJSX0JVU0VSUk9S
ICl7CgkJCXByaW50ZigiRSIpOwoJCQliZXJyY250Kys7CgkJICAgIH0gZWxzZSB7CgkJCXByaW50
ZigiRT8/PyIpOwoJCSAgICB9CgkJICAgIGZmbHVzaChzdGRvdXQpOwoJCX0gZWxzZSB7CgkJICAg
IHJ4Y250W2RldmlkeF0rKzsKCQkgICAgaWYoIChyeGNudFsxXSA9PSB0eG51bSkgJiYKCQkJLyog
V2hlbiBvcHRfdHhkZXZudW09PTEsIHRoZW4gdGhlIHNlY29uZCBwYXJ0IGlzIGFsd2F5cyB0cnVl
ICovCgkJCSgob3B0X3R4ZGV2bnVtPT0xKSB8fCAocnhjbnRbMF0gPT0gdHhudW0pKSApCgkJICAg
IHsKCQkJLyogZG9uZTogc2FtcGxlIHRpbWUgYW5kIHN0b3AgdGVzdGluZyAqLwoJCQljYW50ZXN0
X3Jhdy5kVCAgPSAoZG91YmxlKXVzVGltZXIodDApOwoJCQljYW50ZXN0X3Jhdy5kVCAvPSAxZTY7
CgkJCWdvdG8gZG9uZTsKCQkgICAgfQoJCX0KCSAgICB9IGVsc2UgewoJCWlmKCAoZXJybm8gPT0g
RUFHQUlOKSB8fCAoZXJybm8gPT0gRVdPVUxEQkxPQ0spICl7CgkJICAgIC8qIHRpbWVkIG91dCB3
aGlsZSB3YWl0aW5nLiBUaGlzIGNhbiBvY2N1ciB3aGVuOgoJCSAgICAgICAtIHRoZXJlIGlzIG5v
IG1lc3NhZ2UgcmV0dXJuIGF0IGFsbCAoZS5nLiBubyBzZXJ2ZXIpCgkJICAgICAgIC0gbW9yZSB0
aGFuIHR4YWhlYWQgbWVzc2FnZXMgYXJlIGxvc3QgaW4gc2VxdWVuY2UuCgkJICAgICAgIEJvdGgg
Y29uZGl0aW9ucyBhcmUgY29uc2lkZXJlZCBoYXJkIGVycm9ycy4gKi8KCQkgICAgY2FudGVzdF9y
YXcuZFQgID0gKGRvdWJsZSl1c1RpbWVyKHQwKTsKCQkgICAgY2FudGVzdF9yYXcuZFQgLz0gMWU2
OwoJCSAgICB2cHJpbnRmKFZFUkJfVElNRVJSLCAiXG5FUlJPUjogcmVhZCBFQUdBSU4gYWZ0ZXIg
JWZzICIKCQkJICAgICIocmV0PSVkIHR4Y250PSVkLCByeGNudD0lZCkgIiwKCQkJICAgIGNhbnRl
c3RfcmF3LmRULCBuLCB0eGNudFtkZXZpZHhdLCByeGNudFtkZXZpZHhdKTsKCQkgICAgZ290byBk
b25lOwoJCX0gZWxzZSB7CgkJICAgIGZwcmludGYoc3RkZXJyLCAiXG5FUlJPUjogcmVhZDogcmV0
PSVkLCBlcnJubz0lZCwgcnhjbnQ9JWQgIiwKCQkJICAgIG4sIGVycm5vLCByeGNudFtkZXZpZHhd
KTsKCQkgICAgcmVhZF9lcnJvciA9IDE7CgkJICAgIC8qIERvIG5vdCBicmVhayBoZXJlLCBzbyB3
ZSBjYW4gc2VlIGlmIG1vcmUgbWVzc2FnZQoJCSAgICAgICB3aWxsIGJlIHJlY2VpdmVkIChsaWtl
bHkgYWJvcnRlZCBieSB0aW1lb3V0KSAqLwoJCX0KCSAgICB9CgoJICAgIC8qIE1haW50YWluIHR4
YWhlYWQuIFRoZSB0eC1haGVhZCBvZiBvbmUgY2hhbm5lbCBkZXBlbmRzIG9uIHRoZSByeGNudCBv
ZiB0aGUKCSAgICAgICBvdGhlciBjaGFubmVsLiAqLwoJICAgIHdoaWxlKCAoKHR4Y250W2Rldmlk
eF4xXSAtIHJ4Y250W2RldmlkeF0pIDwgb3B0X3R4YWhlYWQpICYmICh0eGNudFtkZXZpZHheMV0g
PCB0eG51bSkgKXsKCQluID0gd3JpdGUoc29ja2ZkW2RldmlkeF4xXSwgKHZvaWQgKikmKHR4ZGF0
YVtkZXZpZHheMV1bdHhjbnRbZGV2aWR4XjFdXSksIGNhbl9tdHVbZGV2aWR4XjFdKTsKCQlpZiAo
biA8IDApewoJCSAgICBmcHJpbnRmKHN0ZGVyciwgIlxuRVJST1IgaW4gd3JpdGUgKCVkLCBlcnJu
bz0lZCkgIiwgbiwgZXJybm8pOwoJCX0KCQlpZiggb3B0X3ZlcmJvc2UgJiBWRVJCX0xPR01TRyAp
ewoJCSAgICBkYmdfbG9nKGRldmlkeF4xLCBEQkdfTE9HX1RYLCB0eGNudFtkZXZpZHheMV0sIHJ4
Y250W2RldmlkeF4xXSwgCgkJCSAgICAmKHR4ZGF0YVtkZXZpZHheMV1bdHhjbnRbZGV2aWR4XjFd
XSkpOwoJCX0KCQl0eGNudFtkZXZpZHheMV0rKzsKCiNpZiAwCgkJLyogU2ltdWxhdGUgdHggZXJy
b3I6IGRyb3Agb25lIFRYIG1lc3NhZ2VzICovCgkJaWYoIChkZXZpZHggPT0gMCkgJiYgKHR4Y250
W2RldmlkeF0gPT0gMykgKXsKCQkgICAgLyogZHJvcCBhIG1lc3NhZ2UgZm9yIHRlc3RpbmcgKi8K
CQkgICAgcHJpbnRmKCJTSU0gVFhFUlJPUlxuIik7CgkJICAgIHR4Y250W2RldmlkeF4xXSsrOwoJ
CX0KI2VuZGlmCgkgICAgfQoJICAgIGxvb3BjbnQrKzsKCX0KCglpZiggaHVwICl7CgkgICAgYnJl
YWs7Cgl9CiAgICB9CmRvbmU6CgogICAgaWYoIGh1cCApewoJY2FudGVzdF9yYXcuc3RhdHVzID0g
Q1RfUkFXX1RFUk1JTkFURUQ7CglyZXR1cm4gY2FudGVzdF9yYXcuc3RhdHVzOwogICAgfQoKI2lm
IDAKICAgIC8qIFNpbXVsYXRlIG1zZyBlcnJvcjogc3dhcCBSWCBtZXNzYWdlcyAqLwogICAgc3Ry
dWN0IGNhbmZkX2ZyYW1lIGV0bXA7CiAgICBpbnQgbW0xLCBtbTI7CiAgICBtbTE9MjsgbW0yPTM0
OwogICAgbWVtY3B5KCZldG1wLCAgICAgICAgICAgICAmKHJ4ZGF0YVswXVttbTFdKSwgc2l6ZW9m
KHN0cnVjdCBjYW5mZF9mcmFtZSkpOwogICAgbWVtY3B5KCYocnhkYXRhWzBdW21tMV0pLCAmKHJ4
ZGF0YVswXVttbTJdKSwgc2l6ZW9mKHN0cnVjdCBjYW5mZF9mcmFtZSkpOwogICAgbWVtY3B5KCYo
cnhkYXRhWzBdW21tMl0pLCAmZXRtcCwgICAgICAgICAgICAgc2l6ZW9mKHN0cnVjdCBjYW5mZF9m
cmFtZSkpOwogICAgbW0xPTExOyBtbTI9MTc7CiAgICBtZW1jcHkoJmV0bXAsICAgICAgICAgICAg
ICYocnhkYXRhWzBdW21tMV0pLCBzaXplb2Yoc3RydWN0IGNhbmZkX2ZyYW1lKSk7CiAgICBtZW1j
cHkoJihyeGRhdGFbMF1bbW0xXSksICYocnhkYXRhWzBdW21tMl0pLCBzaXplb2Yoc3RydWN0IGNh
bmZkX2ZyYW1lKSk7CiAgICBtZW1jcHkoJihyeGRhdGFbMF1bbW0yXSksICZldG1wLCAgICAgICAg
ICAgICBzaXplb2Yoc3RydWN0IGNhbmZkX2ZyYW1lKSk7CiNlbmRpZgoKICAgIGZpcnN0X2NtcF9l
cnIgPSAxOwogICAgZm9yKGRldmlkeD0ob3B0X3R4ZGV2bnVtPT0yKT8wOjE7IGRldmlkeDwyOyBk
ZXZpZHgrKyl7CgkvKiBjb21wYXJlIFJYIG9mIGRldmlkeCB3aXRoIFRYIG9mIGRldmlkeF4xICh0
aGUgb3RoZXIgY2hhbm5lbCAqLwoJZm9yKCBpZHgxPTA7IGlkeDE8cnhjbnRbZGV2aWR4XTsgaWR4
MSsrICl7CgkgICAgdGhpc3J4ICA9IChyeGRhdGFbZGV2aWR4XVtpZHgxXS5kYXRhWzBdPDw4KSYw
eGZmMDA7CgkgICAgdGhpc3J4IHw9IChyeGRhdGFbZGV2aWR4XVtpZHgxXS5kYXRhWzFdPDwwKSYw
eDAwZmY7CgoJICAgIGlmKCB0aGlzcnggPCB0eG51bSApewoJCWlmKCB0aGlzcnggIT0gaWR4MSAp
ewoJCSAgICBpZiggKHJ4Y250WzFdID09IHBrdG51bSkgJiYgKChvcHRfdHhkZXZudW0gPT0gMSkg
fHwgKHJ4Y250WzBdID09IHBrdG51bSkpICl7CgkJCS8qIE9ubHkgaW5kaWNhdGUgb3V0LW9mLW9y
ZGVyIGVycm9yIHdoZW4gd2UgaGF2ZSB0aGUgY29ycmVjdAoJCQkgICBwYWNrZXQgbnVtYmVyLiBJ
ZiBub3QsIGl0IGlzIG5vdCBvdXQtb2Ytb3JkZXIsIGl0IHdhcyBqdXN0CgkJCSAgIG1lc3NhZ2Ug
bG9zcyAqLwoJCQlvb2NudCA9IDE7CgkJCXByaW50ZigiTyIpOwoJCQlpZiggb3B0X3ZlcmJvc2Ug
JiBWRVJCX0NNUEVSUiApewoJCQkgICAgcHJpbnRmKCJbaWR4PSUuNHgscng9JS40eF0iLCBpZHgx
LCB0aGlzcngpOwoJCQl9CgkJICAgIH0KCQl9CgkJCgkJaWYoIGNtcF9jYW5mcmFtZSgmdHhkYXRh
W2RldmlkeF4xXVt0aGlzcnhdLCAmcnhkYXRhW2RldmlkeF1baWR4MV0sIGNtcF9tdHUpID09IDAg
KXsKCQkgICAgZ29vZGNudFtkZXZpZHhdKys7CgkJfSBlbHNlIHsKCQkgICAgaWYoIG9wdF92ZXJi
b3NlICYgVkVSQl9DTVBFUlIgKXsKCQkJaWYoIGZpcnN0X2NtcF9lcnIgKXsKCQkJICAgIGZwcmlu
dGYoc3Rkb3V0LCAiXG4iKTsKCQkJICAgIGZpcnN0X2NtcF9lcnIgPSAwOwoJCQl9CgkJCWZwcmlu
dGYoc3Rkb3V0LCAiJWQ6IGlkeCU1ZCBleHA6IiwgZGV2aWR4LCBpZHgxKTsKCQkJZnByaW50X2Nh
bmZyYW1lX210dShzdGRvdXQgLCAmdHhkYXRhW2RldmlkeF4xXVtpZHgxXSwgIlxuIiwgMSwgY2Fu
X210dVtkZXZpZHheMV0pOwoJCQlmcHJpbnRmKHN0ZG91dCwgIiVkOiAgICAgICAgICAgcng6Iiwg
ZGV2aWR4KTsKCQkJZnByaW50X2NhbmZyYW1lX210dShzdGRvdXQgLCAmcnhkYXRhW2RldmlkeF1b
aWR4MV0sICJcbiIsIDEsIGNhbl9tdHVbZGV2aWR4XSk7CgkJICAgIH0KCQl9CgkgICAgfSBlbHNl
IHsKCQkvKiBBIHJlY2VpdmUgZXJyb3IgaW4gYnl0ZXMgMCBhbmQgMSwgdGhlIHNlcXVlbmNlIGNv
dW50ZXIKCQkgICBEb250JyBpbmMgZ29vZGNudCwgc28gaXQgd2lsbCBiZSBhbiBlcnJvci4gKi8K
CQlpZiggb3B0X3ZlcmJvc2UgJiBWRVJCX0NNUEVSUiApewoJCSAgICBpZiggZmlyc3RfY21wX2Vy
ciApewoJCQlmcHJpbnRmKHN0ZG91dCwgIlxuIik7CgkJCWZpcnN0X2NtcF9lcnIgPSAwOwoJCSAg
ICB9CgkJICAgIGZwcmludGYoc3Rkb3V0LCAiJWQ6IGlkeCU1ZDogb3V0IG9mIHJhbmdlIHJ4J2Vk
IHNlcXVlbmNlICMgMHgleFxuIiwgZGV2aWR4LCBpZHgxLCB0aGlzcngpOwoJCX0gZWxzZSB7CgkJ
ICAgIHByaW50ZigiSSIpOwoJCX0KCSAgICB9Cgl9CgoJZm9yKCBpZHgxPTA7IGlkeDE8cnhjbnRb
ZGV2aWR4XTsgaWR4MSsrICl7CgkgICAgLyogQ2hlY2sgZm9yIGR1cGxpY2F0ZXMgKi8KCSAgICBp
ZiggcnhpZHhjbnRbZGV2aWR4XVtpZHgxXSA+IDEgKXsKCQlkdXBjbnQrKzsKCQlpZiggb3B0X3Zl
cmJvc2UgJiBWRVJCX0NNUEVSUiApewoJCSAgICBmcHJpbnRmKHN0ZG91dCwgIiVkOiBpZHglNWQ6
IGR1cGxpY2F0ZSAoeCVkKVxuIiwgZGV2aWR4LCBpZHgxLAoJCQkgICAgcnhpZHhjbnRbZGV2aWR4
XVtpZHgxXSk7CgkJfSBlbHNlIHsKCQkgICAgcHJpbnRmKCJEIik7CgkJfQoJICAgIH0KCX0KICAg
IH0KCQogICAgY2FudGVzdF9yYXcuc3BlZWQgPSAoKHJ4Y250WzBdK3J4Y250WzFdKSo4KS8oY2Fu
dGVzdF9yYXcuZFQqMWUzKTsKICAgIGNhbnRlc3RfcmF3Lmxvc3MgPSAwOwogICAgY2FudGVzdF9y
YXcuYmVycmNudCA9IGJlcnJjbnQ7CgogICAgaWYoIChyeGNudFsxXSA8IHBrdG51bSkgfHwgKChv
cHRfdHhkZXZudW0gPT0gMikgJiYgKHJ4Y250WzBdIDwgcGt0bnVtKSkgKXsKCS8qIERpZCBub3Qg
cmVjZWl2ZSB0aGUgcmVxdWVzdGVkIG51bWJlciBvZiBwYWNrZXRzICovCglwcmludGYoIkwiKTsK
CWlmKCBvcHRfdmVyYm9zZSAmIFZFUkJfTE9TU0VSUiApewoJICAgIHByaW50ZigiWyVkIiwgcGt0
bnVtKTsKCSAgICBmb3IoZGV2aWR4PTA7IGRldmlkeDwyOyBkZXZpZHgrKyl7CgkJcHJpbnRmKCIv
JWQ6JWQiLCByeGNudFtkZXZpZHhdLCBnb29kY250W2RldmlkeF0pOwoJCWlmKCByeGNudFtkZXZp
ZHhdID4gMCAmJiByeGNudFtkZXZpZHhdIDwgcGt0bnVtKXsKCQkgICAgLyogUHJpbnQgbWlzc2lu
ZyBwYWNrZXRzLCBBc3N1bWUgdGhhdCB0aGV5IGFyZSBpbiBzdHJpY3Qgc2VxdWVuY2UgKi8KCQkg
ICAgLyogRklYTUU6IFRoaXMgY29kZSBpcyB1Z2x5IHVuZCBub3QgY29tcGxlbHkgY29ycmVjdCAq
LwoJCSAgICBwcmludGYoIihtaXNzaW5nOiIpOwoJCSAgICBleHByeCA9IDA7CgkJICAgIGZvcihp
ZHgxPTA7IChpZHgxPHBrdG51bSkgJiYgKGV4cHJ4PHBrdG51bSk7ICl7CgkJCXRoaXNyeCAgPSAo
cnhkYXRhW2RldmlkeF1baWR4MV0uZGF0YVswXTw8OCkmMHhmZjAwOwoJCQl0aGlzcnggfD0gKHJ4
ZGF0YVtkZXZpZHhdW2lkeDFdLmRhdGFbMV08PDApJjB4MDBmZjsKCQkJaWYoIHRoaXNyeCAhPSBl
eHByeCApewoJCQkgICAgcHJpbnRmKCIlLjR4LCIsIGV4cHJ4KTsKCQkJICAgIGV4cHJ4ID0gdGhp
c3J4OwoJCQkgICAgY29udGludWU7CgkJCX0gZWxzZSB7CgkJCSAgICBpZHgxKys7CgkJCSAgICBl
eHByeCsrOwoJCQl9CgkJICAgIH0KCQkgICAgcHJpbnRmKCIpIik7CgkJfQoJICAgIH0KCSAgICBw
cmludGYoIl0iKTsKCX0KCWlmKCBvcHRfdHhkZXZudW0gPT0gMiApewoJICAgIGNhbnRlc3RfcmF3
Lmxvc3MgKz0gKHBrdG51bS1yeGNudFswXSk7Cgl9CgljYW50ZXN0X3Jhdy5sb3NzICs9IChwa3Ru
dW0tcnhjbnRbMV0pOwoJaWYoIChyeGNudFsxXSA9PSAwKSB8fCAoKG9wdF90eGRldm51bSA9PSAy
KSAmJiAocnhjbnRbMV0gPT0gMCkpICl7CgkgICAgY2FudGVzdF9yYXcuc3RhdHVzID0gQ1RfUkFX
X05PX1JFU1BPTlNFOwoJfSBlbHNlIHsKCSAgICBjYW50ZXN0X3Jhdy5zdGF0dXMgPSBDVF9SQVdf
VElNRU9VVDsKCX0KICAgIH0gZWxzZSB7CgkvKiByZXF1ZXN0ZWQgbnVtYmVyIG9mIHBhY2tldHMg
YXJyaXZlZCAqLwoKCWlmKCAocnhjbnRbMF0rcnhjbnRbMV0pID09IChnb29kY250WzBdK2dvb2Rj
bnRbMV0pICl7CgkgICAgaWYoIGR1cGNudCApewoJCWNhbnRlc3RfcmF3LnN0YXR1cyA9IENUX1JB
V19EVVBMSUNBVEVTOwoJICAgIH0gZWxzZSBpZiggYmVycmNudCApewoJCWlmKCBvcHRfYWxsb3dl
cnIgICl7CgkJICAgIGNhbnRlc3RfcmF3LnN0YXR1cyA9IDA7CgkJfSBlbHNlIHsKCQkgICAgY2Fu
dGVzdF9yYXcuc3RhdHVzID0gQ1RfUkFXX0JVU19FUlJPUlM7CgkJfQoJICAgIH0gZWxzZSB7CgkJ
aWYoIG9vY250ICl7CgkJICAgIGNhbnRlc3RfcmF3LnN0YXR1cyA9IENUX1JBV19CQURfT1JERVI7
CgkJfSBlbHNlIHsKCQkgICAgY2FudGVzdF9yYXcuc3RhdHVzID0gMDsKCQl9CgkgICAgfQoJfSBl
bHNlIHsKCSAgICBjYW50ZXN0X3Jhdy5zdGF0dXMgPSBDVF9SQVdfQkFEX1JFQ0VJVkU7Cgl9CiAg
ICB9CgogICAgaWYoIG9wdF92ZXJib3NlICYgVkVSQl9TVEFUUyApewoJcHJpbnRmKCJzdGF0dXM9
JWQgIiwgY2FudGVzdF9yYXcuc3RhdHVzKTsKCXByaW50ZigiZFQ9JS42ZiAiLCBjYW50ZXN0X3Jh
dy5kVCk7CglwcmludGYoInNwZWVkPSUuMWYgIiwgY2FudGVzdF9yYXcuc3BlZWQpOwoJcHJpbnRm
KCJsb3NzPSVkICIsIGNhbnRlc3RfcmF3Lmxvc3MpOwoJcHJpbnRmKCJcbiIpOwogICAgfQoKICAg
IGlmKCByZWFkX2Vycm9yICl7CgljYW50ZXN0X3Jhdy5zdGF0dXMgPSBDVF9SQVdfUkVBRF9FUlJP
UjsKICAgIH0KCiAgICByZXR1cm4gY2FudGVzdF9yYXcuc3RhdHVzOwp9CgoKLyogRnJlZSBhbGwg
cmVzb3VyY2VzIHdlIHVzZWQgYW5kIHJldHVybiB3aXRoIDxyZXRWYWw+ICovCnN0YXRpYyBpbnQg
Y2xlYW51cCgKICAgIGludCAgICAgcmV0dmFsCikKewogICAgaWYoIHNvY2tmZFswXSApewoJY2xv
c2Uoc29ja2ZkWzBdKTsKICAgIH0KICAgIGlmKCBzb2NrZmRbMV0gKXsKCWNsb3NlKHNvY2tmZFsx
XSk7CiAgICB9CgogICAgaWYoIG9wdF90ZXJtICl7CgkvKiBUdXJuIG9mZiwgZG9udCBjYXJlIGZv
ciBlcnJvcyAqLwoJc2V0X2Nhbl90ZXJtKG9wdF9jYW5kZXZbMF0sIDApOwoJc2V0X2Nhbl90ZXJt
KG9wdF9jYW5kZXZbMV0sIDApOwogICAgfQoKICAgIGlmKCBzaWdpbnQgKXsKCXJldHVybiAyNTU7
CiAgICB9CiAgICByZXR1cm4gcmV0dmFsOwp9CgovKiBwYXJzZSBmb3Igb3B0X2ZsYWdzLCByZXR1
cm4gLTEgaWYgZXJyb3IgKi8KaW50IHBhcnNlX2ZsYWdzKAogICAgY29uc3QgY2hhciAqZmxhZ3MK
KQp7CiAgICBjb25zdCBjaGFyICAgKnA7CiAgICBpbnQgICAgICAgICAgb3B0X2ZsYWdzOwoKICAg
IG9wdF9mbGFncyA9IDA7CiAgICBpZiggc3NjYW5mKGZsYWdzLCAiJWkiLCAmb3B0X2ZsYWdzKSAh
PSAxICl7CglwID0gZmxhZ3M7Cgl3aGlsZSggKnAgIT0gJ1wwJyApewoJICAgIGlmKCBzdHJzdHIo
cCwgIm5vcmFuZG9tZGF0YSIpID09IHAgKXsKCQlvcHRfZmxhZ3MgfD0gRkxBR1NfTk9SQU5ET01E
QVRBOwoJICAgIH0gZWxzZSBpZiggc3Ryc3RyKHAsICJyYW5kb21pemUiKSA9PSBwICl7CgkJb3B0
X2ZsYWdzIHw9IEZMQUdTX1JBTkRPTUlaRTsKCSAgICB9IGVsc2UgaWYoIHN0cnN0cihwLCAicmVm
aWxsZGF0YSIpID09IHAgKXsKCQlvcHRfZmxhZ3MgfD0gRkxBR1NfUkVGSUxMREFUQTsKCSAgICB9
IGVsc2UgaWYoIHN0cnN0cihwLCAiYWxsb3dvb29kIikgPT0gcCApewoJCW9wdF9mbGFncyB8PSBG
TEFHU19BTExPV09PT0Q7CgkgICAgfSBlbHNlIGlmKCBzdHJzdHIocCwgImxlc3Nkb3RzIikgPT0g
cCApewoJCW9wdF9mbGFncyB8PSBGTEFHU19MRVNTRE9UUzsKCSAgICB9IGVsc2UgaWYoIHN0cnN0
cihwLCAibGVhc3Rkb3RzIikgPT0gcCApewoJCW9wdF9mbGFncyB8PSBGTEFHU19MRUFTVERPVFM7
CgkgICAgfSBlbHNlIGlmKCBzdHJzdHIocCwgInN0b3BvbmVycm9yIikgPT0gcCApewoJCW9wdF9m
bGFncyB8PSBGTEFHU19TVE9QT05FUlJPUjsKCSAgICB9IGVsc2UgewoJCXJldHVybiAtMTsKCSAg
ICB9CgkgICAgLyogc2tpcCBhZnRlciBuZXh0IGNvbW1hLCBvciBicmVhayBpZiB0aGUgaXMgbm9u
ZSAqLwoJICAgIGlmKCAocD1zdHJzdHIocCwgIiwiKSkgKXsKCQlwKys7CgkgICAgfSBlbHNlIHsK
CQlicmVhazsKCSAgICB9Cgl9CiAgICB9CiAgICByZXR1cm4gb3B0X2ZsYWdzOwp9CgovKiBwYXJz
ZSBmb3Igb3B0X3ZlcmJvc2UsIHJldHVybiAtMSBpZiBlcnJvciAqLwppbnQgcGFyc2VfdmVyYm9z
ZSgKICAgIGNvbnN0IGNoYXIgKnZlcmJvc2UKKQp7CiAgICBjb25zdCBjaGFyICAgKnA7CiAgICBp
bnQgICAgICAgICAgb3B0X3ZlcmJvc2U7CgogICAgb3B0X3ZlcmJvc2UgPSAwOwogICAgaWYoIHNz
Y2FuZih2ZXJib3NlLCAiJWkiLCAmb3B0X3ZlcmJvc2UpICE9IDEgKXsKCXAgPSB2ZXJib3NlOwoJ
d2hpbGUoICpwICE9ICdcMCcgKXsKCSAgICBpZiggc3Ryc3RyKHAsICJzdGF0cyIpID09IHAgKXsK
CQlvcHRfdmVyYm9zZSB8PSBWRVJCX1NUQVRTOwoJICAgIH0gZWxzZSBpZiggc3Ryc3RyKHAsICJp
ZnByb3AiKSA9PSBwICl7CgkJb3B0X3ZlcmJvc2UgfD0gVkVSQl9JRlBST1A7CgkgICAgfSBlbHNl
IGlmKCBzdHJzdHIocCwgInRpbWVyciIpID09IHAgKXsKCQlvcHRfdmVyYm9zZSB8PSBWRVJCX1RJ
TUVSUjsKCSAgICB9IGVsc2UgaWYoIHN0cnN0cihwLCAiY21wZXJyIikgPT0gcCApewoJCW9wdF92
ZXJib3NlIHw9IFZFUkJfQ01QRVJSOwoJICAgIH0gZWxzZSBpZiggc3Ryc3RyKHAsICJsb2dtc2ci
KSA9PSBwICl7CgkJb3B0X3ZlcmJvc2UgfD0gVkVSQl9MT0dNU0c7CgkgICAgfSBlbHNlIGlmKCBz
dHJzdHIocCwgImxvc3NlcnIiKSA9PSBwICl7CgkJb3B0X3ZlcmJvc2UgfD0gVkVSQl9MT1NTRVJS
OwoJICAgIH0gZWxzZSB7CgkJcmV0dXJuIC0xOwoJICAgIH0KCSAgICAvKiBza2lwIGFmdGVyIG5l
eHQgY29tbWEsIG9yIGJyZWFrIGlmIHRoZSBpcyBub25lICovCgkgICAgaWYoIChwPXN0cnN0cihw
LCAiLCIpKSApewoJCXArKzsKCSAgICB9IGVsc2UgewoJCWJyZWFrOwoJICAgIH0KCX0KICAgIH0K
ICAgIHJldHVybiBvcHRfdmVyYm9zZTsKfQoKI2RlZmluZSB4c3RyKGEpIHN0cihhKQojZGVmaW5l
IHN0cihhKSAjYQoKLyoKICogU2hvdyBoZWxwCiAqCiAqIFJFVFVSTlM6IE4vQQogKi8Kdm9pZCB1
c2FnZSh2b2lkKQp7CiAgICBmcHJpbnRmKAoJc3Rkb3V0LAoJLyogICAgICAgIDEgICAgICAgICAy
ICAgICAgICAgMyAgICAgICAgIDQgICAgICAgICA1ICAgICAgICAgNiAgICAgICAgIDcgICAgICAg
ICA4ICovCgkvKiAzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4
OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTAgKi8KCSJzY3Rlc3QgLSBTb2NrZXRDQU4g
dHdvIG5vZGUgdHJhbnNtaXNzaW9uIHRlc3QgcHJvZ3JhbVxuIgoJIlVTQUdFOiBzY3Rlc3QgW29w
dGlvbnNdIFtjYW54LW5ldGlmXSBbY2FueS1uZXRpZl1cbiIKCSJWRVJTSU9OOiAkSWQ6IHNjdGVz
dC5jIDQwMjAgMjAyMy0wMS0xNyAyMjowOToyNFogYXMgJCAiCgkiJEdsYlJldjogIiBfX1NWTkdM
QlJFVl9fICIgJFxuIgoJIkJVSUxUOiAiIF9fREFURV9fICIgIiBfX1RJTUVfXyAiXG4iCgkiXG4i
CgkiVGhlIHByb2dyYW0gc2VuZHMgb3V0IHNvbWUgdHgtYWhlYWQgcGFja2V0cyBvbiBib3RoIGNh
biBpbnRlcmZhY2VzLlxuIgoJIkl0IHdhaXRzIGZvciBtZXNzYWdlcyB0byBiZSByZWNpZXZlZCBv
biB0aGUgb3Bwb3NpdGUgY2hhbm5lbC4gT24gZXZlcnkgcmVjZWlwdCxcbiIKCSJ0aGUgbmV4dCBt
ZXNzYWdlIGlzIHRyYW5zbWl0dGVkLlxuIgoJIldoZW4gYWxsIG1lc3NhZ2VzIGFyZSB0cmFuc21p
dHRlZCBhbmQgcmVjZWl2ZWQsIGRhdGEgaXMgY2hlY2tlZCBmb3IgZXF1YWxuZXNzLlxuIgoJIlxu
IgoJIlRoZSBmb2xsb3dpbmcgaW5kaWNhdG9ycyBhcmUgcHJpbnRlZDogRW9mZiB3aGVuIGJ1cy1v
ZmYgaXMgZGV0ZWN0ZWQsIEVhY2tcbiIKCSJ3aGVuIGFja25vd2xlZGdlIGVycm9yIGlzIGRldGVj
dGVkLCBFIGlmIGEgYnVzLWVycm9yIChlLmcuIENSQykgaXMgZGV0ZWN0ZWQuXG4iCgkiRT8/PyBp
cyBwcmludGVkIGZvciBlcnJvciB0aGF0IGlzIG5vdCBkZWNoaXBlcmVkLlxuIgoJIlxuIgoJIlNj
dGVzdCBjaGFuZ2VzIHNvbWUgc29ja2V0Y2FuIG9wdGlvbnMsIGhlbmNlIHRoZSBpbnRlcmZhY2Vz
IGFyZSBwdXQgaW50b1xuIgoJImRvd24gc3RhdGUgZHVpbmcgcHJvZ3JhbSBzdGFydC5cbiIKCSJc
biIKCSJPUFRJT05TOlxuIgoJIiAgLWwgPGxvb3BzPiA6ICBOdW1iZXIgb2YgdGVzdCBsb29wcyAo
ZGVmYXVsdCAiIHhzdHIoREZMVExPT1BTKQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAiLCBtYXggIiB4c3RyKE1BWExPT1BTKSAiKVxuIgoJIiAgLW4gPG1zZ3M+ICA6ICBN
ZXNzYWdlcyBzZW50IGluIG9uZSBsb29wIChkZWZhdWx0ICIgeHN0cihERkxUUEtUTlVNKQoJICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiLCBtYXggIiB4c3RyKE1BWFBLVE5V
TSkgIilcbiIKCSIgIC1pIDxpZD4gICAgOiAgQ0FOIElEIHRvIHVzZSBmb3IgY2FueC1uZXRpZiB0
cmFuc21pdC4gY2FueS1uZXRpZiB3aWxsXG4iCgkiICAgICAgICAgICAgICAgIHVzZSBJRCsxIChk
ZWZhdWx0ICIgeHN0cihERkxUSUQpICIpXG4iCgkiICAtZSAgICAgICAgIDogIFRyYW5zbWl0IGV4
dGVuZGVkIGZvcm1hdCBmcmFtZXNcbiIKCSIgIC1kIDxkbGVuPiAgOiAgRGF0YSBieXRlcyBmb3Ig
b25lIG1lc3NhZ2UgKGRlZmF1bHQgPSBNVFUpXG4iCgkiICAtYiAgICAgICAgIDogIEVuYWJsZSBi
aXRyYXRlIHN3aXRjaFxuIgoJIiAgLXQgPG51bT4gICA6ICBudW1iZXIgb2YgdHgtYWhlYWQgbWVz
c2FnZXMgKGRlZmF1bHQgIiB4c3RyKERGTFRUWEFIRUFEKSAiKVxuIgoJIiAgLVQgPG1zZWNzPiA6
ICB0aW1lb3V0IGZvciBvbmUgbWVzc2FnZSAoZGVmYXVsdCAiIHhzdHIoREZMVFRJTUVPVVQpICIg
bXMpXG4iCgkiICAtdSAgICAgICAgIDogIFVuaWRpcmVjdGlvbmFsIG9wZXJhdGlvbi4gTWVzc2Fn
ZXMgYXJlIG9ubHkgc2VuZCBvbiBjYW54LW5ldGlmXG4iCgkiICAgICAgICAgICAgICAgIGFuZCBy
ZWNlaXZlZCBieSBjYW55LW5ldGlmXG4iCgkiICAtZSAgICAgICAgIDogIFNlbmQgdHJhbnNtaXQg
ZXh0ZW5kZWQgZnJhbWVzXG4iCgkiICAtRiA8ZmxhZ3M+IDogIE1vZGlmeSBvcGVyYXRpb24gYnkg
Y29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgbW9kaWZpZXJzXG4iCgkiICAgICAgICAgICAgICAgIG9y
IGJ5IGJpdG1hc2sgdmFsdWU6XG4iCgkiICAgICAgICAgICAgICAgIG5vcmFuZG9tZGF0YSAoIiB4
c3RyKEZMQUdTX05PUkFORE9NREFUQSkgIik6IG5vbi1yYW5kb20gZGF0YSBwYXlsb2FkLlxuIgoJ
IiAgICAgICAgICAgICAgICByYW5kb21pemUgKCIgeHN0cihGTEFHU19SQU5ET01JWkUpICIpOiBy
YW5kb21pemUgcGFyYW1ldGVycy5cbiIKCSIgICAgICAgICAgICAgICAgICAgZGxlbiA9IDIgLi4g
ZGxlbi5cbiIKCSIgICAgICAgICAgICAgICAgcmVmaWxsZGF0YSAoIiB4c3RyKEZMQUdTX1JFRklM
TERBVEEpICIpOiBkYXRhIHBheWxvYWQgaXMgcmFuZG9taXplZCBmb3JcbiIKCSIgICAgICAgICAg
ICAgICAgICBldmVyeSBwcm9ncmFtIGxvb3AuIEluY3JlYXNlcyBydW50aW1lLCBidXQgbWF5IGhl
bHAgdG9cbiIKCSIgICAgICAgICAgICAgICAgICBpZGVudGlmeSBhIHNlbnQgbWVzc2FnZXMgbW9y
ZSBlYXNpbHlcbiIKCSIgICAgICAgICAgICAgICAgYWxsb3dvb29kICgiIHhzdHIoRkxBR1NfQUxM
T1dPT09EKSAiKTogYWxsb3cgb3V0IG9mIG9yZGVyXG4iCgkiICAgICAgICAgICAgICAgICAgcmVj
ZWlwdGlvbi4gSWYgdGhpcyBoYXBwZW5zLCB0aGVuIE8gaXMgcHJpbnRlZCB0byBzdGRvdXQuXG4i
CgkiICAgICAgICAgICAgICAgIGxlc3Nkb3RzICgiIHhzdHIoRkxBR1NfTEVTU0RPVFMpICIpOiBw
cmludCBkb3Qgb25seSBldmVyeSAxMHRoIGxvb3AgZG90LlxuIgoJIiAgICAgICAgICAgICAgICBs
ZWFzdGRvdHMgKCIgeHN0cihGTEFHU19MRUFTVERPVFMpICIpOiBwcmludCBkb3Qgb25seSBldmVy
eSAxMDB0aCBsb29wLlxuIgoJIiAgICAgICAgICAgICAgICBzdG9wb25lcnJvciAoIiB4c3RyKEZM
QUdTX1NUT1BPTkVSUk9SKSAiKTogRG9udCBjbGVhbnVwIGFuZCBleGl0XG4iCgkiICAtRSAgICAg
ICAgIDogIGlnbm9yZSBidXMgZXJyb3JzIChlLmcuIGluIEVNQyB0ZXN0KVxuIgoJIiAgLXogPG1z
ZWNzPiA6ICBkZWxheSBhZnRlciBlYWNoIGxvb3AgKGRlZmF1dCAwbXMpXG4iCgkiICAtciA8cHJp
bz4gIDogIGVuYWJsZSByZWFsdGltZSB0YXNrIHdpdGggcHJpbyA8cHJpbz5cbiIKCSIgIC1SICAg
ICAgICAgOiAgZW5hYmxlIHRlcm1pbmF0aW9uIHJlc2lzdG9yIG9uIGNhbngtbmV0aWYuIER1cGxp
Y2F0ZSBvcHRpb24gdG9cbiIKCSIgICAgICAgICAgICAgICAgZW5hYmxlIHRlcm1pbmF0aW9uIG9u
IGJvdGggbmV0aWZzLlxuIgoJLyogMzQ1Njc4OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4
OTAxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwICovCgkiICAtWCA8bG9n
ZGV2PjogIEluIGNhc2Ugb2YgZXJyb3IgdHJ5IHRvIGNhcHR1cmUgbG9nZ2VkIGRhdGEgZnJvbSBl
eHRlcm5hbFxuIgoJIiAgICAgICAgICAgICAgICBsb2dnZXIuIEN1cnJlbnRseSBvbnlsIGF2YWls
YWJsZSB3aXRoIElDQU5PUyBpY2FuYnVmZiB0b29sLlxuIgoJIiAgICAgICAgICAgICAgICBVc2Ug
cGFyYW1ldGVyIGhvc3RuYW1lOnBvcnRubyB0byBzZWxlY3Qgd2hpY2ggZGV2aWNlIHRvIHVzZS5c
biIKCSIgIC1ZIDxtc2c+IDogICAgSnVzdCBzZW5kIGEgQ0FOIGZyYW1lIG9uIGNhbngtbmV0aWYg
YW5kIGNhbnktbmV0aWYgZm9yIGRldGVjdGlvblxuIgoJIiAgICAgICAgICAgICAgICBwdXJwb3Nl
cy4gVGhlIGFyZ3VtZW50IGlzIGEgaGV4IGRpZ2l0IHdoaWNoIGlzIHVzZWQgYXMgZGF0YVxuIgoJ
IiAgICAgICAgICAgICAgICBwYXlsb2FkLlxuIgoJIiAgLXYgPGxldmVsPiA6ICBTZWxlY3QgdmVy
Ym9zZSBvdXRwdXQgYnkgY29tbWEgc2VwYXJhdGVkIGxpc3Qgb2Ygb3B0aW9uc1xuIgoJIiAgICAg
ICAgICAgICAgICBvciBieSBiaXRtYXNrIHZhbHVlOlxuIgoJIiAgICAgICAgICAgICAgICBzdGF0
cyAoIiB4c3RyKFZFUkJfU1RBVFMpICIpOiBwZXIgbG9vcCBzdGF0aXN0aWNzXG4iCgkiICAgICAg
ICAgICAgICAgIGlmcHJvcCAoIiB4c3RyKFZFUkJfSUZQUk9QKSAiKTogaW50ZXJmYWNlIHByb3Bl
cnRpZXNcbiIKCSIgICAgICAgICAgICAgICAgdGltZXJyICgiIHhzdHIoVkVSQl9USU1FUlIpICIp
OiBzaG93IHRpbWVvdXQgZXJyb3IgZGV0YWlsc1xuIgoJIiAgICAgICAgICAgICAgICBjbXBlcnIg
KCIgeHN0cihWRVJCX0NNUEVSUikgIik6IHNob3cgY29tcGFyZSBlcnJvciBkZXRhaWxzXG4iCgki
ICAgICAgICAgICAgICAgIGxvZ21zZyAoIiB4c3RyKFZFUkJfTE9HTVNHKSAiKTogbG9nIHR4L3J4
LWVkIGZyYW1lcyBhbmRcbiIKCSIgICAgICAgICAgICAgICAgICAgICBwcmludCBvbiBlcnJvclxu
IgoJIlxuIgogICAgKTsKfQoKaW50IG1haW4oaW50IGFyZ2MsIGNoYXIqKiBhcmd2KSB7CiAgICBp
bnQgICAgICAgIHJjOwogICAgdGltZV90ICAgICB0OwogICAgaW50ICAgICAgICBkZXZpZHg7CiAg
ICBpbnQgICAgICAgIG9wdDsKICAgIGludCAgICAgICAgaSxuOwogICAgaW50ICAgICAgICBsb29w
OwogICAgaW50ICAgICAgICB0eGNudDsKICAgIHN0cnVjdCBzY2hlZF9wYXJhbSBwYXJhbTsKICAg
IHN0cnVjdCBzb2NrYWRkcl9jYW4gYWRkcjsKICAgIHN0cnVjdCBpZnJlcSBpZnI7CiAgICBzdHJ1
Y3QgY2FuX2N0cmxtb2RlIGNtOwogICAgY2FuX2Vycl9tYXNrX3QgZXJyX21hc2s7CiAgICBpbnQg
ICAgICAgIGVuYWJsZV9jYW5mZDsKCgogICAgaHVwID0gMDsKICAgIHNpZ2ludCA9IDA7CiAgICBk
YmdfbG9nX3BvcyA9IDA7CgogICAgb3B0X3ZlcmJvc2UgPSAwOwogICAgb3B0X3J0ID0gMDsKICAg
IG9wdF9wa3RzID0gREZMVFBLVE5VTTsKICAgIG9wdF9sb29wcyA9IERGTFRMT09QUzsKICAgIG9w
dF9sZGVsYXkgPSAwOwogICAgb3B0X3RpbWVvdXQgPSBERkxUVElNRU9VVDsKICAgIG9wdF9hbGxv
d2VyciA9IDA7CiAgICBvcHRfdHhhaGVhZCA9IERGTFRUWEFIRUFEOwogICAgb3B0X2ZsYWdzID0g
MDsKICAgIG9wdF90ZXJtID0gMDsKICAgIG9wdF9kbGVuID0gLTE7CiAgICBvcHRfZWZmID0gMDsK
ICAgIG9wdF9icnMgPSAwOwogICAgb3B0X3R4ZGV2bnVtID0gMjsKICAgIG9wdF9sb2dnZXIgPSAw
OwogICAgb3B0X3NlbmQgPSAwOwogICAgb3B0X2lkID0gREZMVElEOwoKICAgIC8qCiAgICAgKiBQ
YXJzZSBjb21tYW5kIGxpbmUgYXJndW1lbnRzCiAgICAgKi8KICAgIHdoaWxlICgob3B0ID0gZ2V0
b3B0KGFyZ2MsIGFyZ3YsICJiZDplRUY6aTpobDpuOnI6UnQ6VDp1djpYOlk6ejoiKSkgIT0gLTEp
IHsKCXN3aXRjaCAob3B0KSB7CgljYXNlICdiJzoKCSAgICBvcHRfYnJzID0gMTsKCSAgICBicmVh
azsKCWNhc2UgJ2QnOgoJICAgIG9wdF9kbGVuID0gc3RydG9sKG9wdGFyZywgMCwgMCk7CgkgICAg
YnJlYWs7CgljYXNlICdlJzoKCSAgICBvcHRfZWZmID0gMTsKCSAgICBicmVhazsKCWNhc2UgJ0Un
OgoJICAgIG9wdF9hbGxvd2VyciA9IDE7CgkgICAgYnJlYWs7CgljYXNlICdGJzoKCSAgICBvcHRf
ZmxhZ3MgPSBwYXJzZV9mbGFncyhvcHRhcmcpOwoJICAgIGlmKCBvcHRfZmxhZ3MgPT0gLTEgKXsK
CQlmcHJpbnRmKHN0ZGVyciwgInVucmVjb2duaXNlZCAtRiBmbGFnXG4iKTsKCQlleGl0KDEpOwoJ
ICAgIH0KCSAgICBicmVhazsKCWNhc2UgJ2knOgoJICAgIG9wdF9pZCA9IHN0cnRvbChvcHRhcmcs
IDAsIDApOwoJICAgIGJyZWFrOwoJY2FzZSAnbCc6CgkgICAgb3B0X2xvb3BzID0gc3RydG9sKG9w
dGFyZywgMCwgMCk7CgkgICAgYnJlYWs7CgljYXNlICduJzoKCSAgICBvcHRfcGt0cyA9IHN0cnRv
bChvcHRhcmcsIDAsIDApOwoJICAgIGJyZWFrOwoJY2FzZSAncic6CgkgICAgb3B0X3J0ID0gc3Ry
dG9sKG9wdGFyZywgMCwgMCk7CgkgICAgYnJlYWs7CgljYXNlICdSJzoKCSAgICBvcHRfdGVybSsr
OwoJICAgIGJyZWFrOwoJY2FzZSAndCc6CgkgICAgb3B0X3R4YWhlYWQgPSBzdHJ0b2wob3B0YXJn
LCAwLCAwKTsKCSAgICBicmVhazsKCWNhc2UgJ1QnOgoJICAgIG9wdF90aW1lb3V0ID0gc3RydG9s
KG9wdGFyZywgMCwgMCk7CgkgICAgYnJlYWs7CgljYXNlICd1JzoKCSAgICBvcHRfdHhkZXZudW0g
PSAxOwoJICAgIGJyZWFrOwoJY2FzZSAndic6CgkgICAgb3B0X3ZlcmJvc2UgPSBwYXJzZV92ZXJi
b3NlKG9wdGFyZyk7CgkgICAgaWYoIG9wdF92ZXJib3NlID09IC0xICl7CgkJZnByaW50ZihzdGRl
cnIsICJ1bnJlY29nbmlzZWQgLXYgZmxhZ1xuIik7CgkJZXhpdCgxKTsKCSAgICB9CgkgICAgYnJl
YWs7CgljYXNlICdYJzoKCSAgICBvcHRfbG9nZ2VyID0gb3B0YXJnOwoJICAgIGJyZWFrOwoJY2Fz
ZSAnWSc6CgkgICAgb3B0X3NlbmQgPSBvcHRhcmc7CgkgICAgYnJlYWs7CgljYXNlICd6JzoKCSAg
ICBvcHRfbGRlbGF5ID0gc3RydG91bChvcHRhcmcsIDAsIDApOwoJICAgIGJyZWFrOwoJY2FzZSAn
aCc6CglkZWZhdWx0OgoJICAgIHVzYWdlKCk7CgkgICAgZXhpdCgxKTsKCX0KICAgIH0KCiAgICBp
ZiAob3B0aW5kICE9IChhcmdjIC0gMikpIHsKCWZwcmludGYoc3RkZXJyLCAibWlzc2luZyBuZXR3
b3JrIGludGVyZmFjZSBvcHRpb25cbiIpOwoJdXNhZ2UoKTsKCXJldHVybiAxOwogICAgfQogICAg
b3B0X2NhbmRldlswXSA9IGFyZ3Zbb3B0aW5kXTsKICAgIG9wdF9jYW5kZXZbMV0gPSBhcmd2W29w
dGluZCsxXTsKCiAgICBzaWduYWwoU0lHSU5ULCBzZXRfaHVwKTsKICAgIHNpZ25hbChTSUdIVVAs
IHNldF9odXApOwogICAgc2lnbmFsKFNJR1RFUk0sIHNldF9odXApOwoKICAgIGlmKCBvcHRfbG9v
cHMgPj0gTUFYTE9PUFMgKXsKCWZwcmludGYoc3RkZXJyLCAiZXJyb3I6IC1sIG11c3QgYmUgbGVz
cyB0aGFuICVkXG4iLCBNQVhMT09QUyk7CglleGl0KGNsZWFudXAoMSkpOwogICAgfQogICAgaWYo
IG9wdF9wa3RzID49IE1BWFBLVE5VTSApewoJZnByaW50ZihzdGRlcnIsICJlcnJvcjogLW4gbXVz
dCBiZSBsZXNzIHRoYW4gJWRcbiIsIE1BWFBLVE5VTSk7CglleGl0KGNsZWFudXAoMSkpOwogICAg
fQogICAgCiAgICBwcmludGYoIkNBTiB0ZXN0ICVzICVzICIsIG9wdF9jYW5kZXZbMF0sIG9wdF9j
YW5kZXZbMV0pOwoKICAgIGlmKCBvcHRfdGVybSApewoJaWYoICEgc2V0X2Nhbl90ZXJtKG9wdF9j
YW5kZXZbMF0sIDEpICl7CgkgICAgZnByaW50ZihzdGRlcnIsICJjYW4gbm90IGVuYWJsZSB0ZXJt
aW5hdGlvbiAlc1xuIiwgb3B0X2NhbmRldlswXSk7CgkgICAgZXhpdChjbGVhbnVwKDgwKSk7Cgl9
CglpZiggb3B0X3Rlcm0gPiAxICl7CgkgICAgaWYoICEgc2V0X2Nhbl90ZXJtKG9wdF9jYW5kZXZb
MV0sIDEpICl7CgkJZnByaW50ZihzdGRlcnIsICJjYW4gbm90IGVuYWJsZSB0ZXJtaW5hdGlvbiAl
c1xuIiwgb3B0X2NhbmRldlsxXSk7CgkJZXhpdChjbGVhbnVwKDgwKSk7CgkgICAgfQoJfQogICAg
fQoKICAgIGZvcihkZXZpZHg9MDsgZGV2aWR4PDI7IGRldmlkeCsrKXsKCS8qCgkgKiBDb25maWd1
cmUgQ0FOIG9wdF9jYW5kZXYgZ2xvYmFsIG9wdGlvbnMuIEhlcmUgb25seSBidXMgZXJyb3IKCSAq
IHJlcG9ydGluZy4gV2UgZG9uJ3QgY2FyZSBpZiBpdCBpcyBub3Qgc3VwcG9ydGVkLgoJICovCglp
ZiAoY2FuX2RvX3N0b3Aob3B0X2NhbmRldltkZXZpZHhdKSA8IDApIHsKCSAgICBmcHJpbnRmKHN0
ZGVyciwgIiVzOiBmYWlsZWQgdG8gc3RvcFxuIiwgb3B0X2NhbmRldltkZXZpZHhdKTsKCSAgICBl
eGl0KGNsZWFudXAoMSkpOwoJfQoKCWNtLm1hc2sgID0gQ0FOX0NUUkxNT0RFX0JFUlJfUkVQT1JU
SU5HOwoJY20uZmxhZ3MgPSBjbS5tYXNrOwoKCWlmIChjYW5fc2V0X2N0cmxtb2RlKG9wdF9jYW5k
ZXZbZGV2aWR4XSwgJmNtKSA8IDApIHsKCSAgICBmcHJpbnRmKHN0ZGVyciwgIiVzOiBmYWlsZWQg
dG8gc2V0IGNvbnRyb2xtb2RlXG4iLCBvcHRfY2FuZGV2W2RldmlkeF0pOwoJICAgIGV4aXQoY2xl
YW51cCgxKSk7Cgl9CgoJaWYgKGNhbl9kb19zdGFydChvcHRfY2FuZGV2W2RldmlkeF0pIDwgMCkg
ewoJICAgIGZwcmludGYoc3RkZXJyLCAiJXM6IGZhaWxlZCB0byBzdGFydFxuIiwgb3B0X2NhbmRl
dltkZXZpZHhdKTsKCSAgICBleGl0KGNsZWFudXAoMSkpOwoJfQogICAgCgkvKgoJICogT3BlbiBD
QU4gbmV0d29yayBkZXZpY2VzCgkgKi8KCXNvY2tmZFtkZXZpZHhdID0gc29ja2V0KFBGX0NBTiwg
U09DS19SQVcsIENBTl9SQVcpOwoJaWYgKC0xID09IHNvY2tmZFtkZXZpZHhdKSB7CgkgICAgcGVy
cm9yKCJzb2NrZXQiKTsKCSAgICBleGl0KGNsZWFudXAoMSkpOwoJfQoKCS8vIEdldCB0aGUgaW5k
ZXggb2YgdGhlIG5ldHdvcmsgb3B0X2NhbmRldgoJc3RybmNweShpZnIuaWZyX25hbWUsIG9wdF9j
YW5kZXZbZGV2aWR4XSwgSUZOQU1TSVopOwoJaWYgKGlvY3RsKHNvY2tmZFtkZXZpZHhdLCBTSU9D
R0lGSU5ERVgsICZpZnIpID09IC0xKSB7CgkgICAgcGVycm9yKCJpb2N0bCIpOwoJICAgIGV4aXQo
Y2xlYW51cCgxKSk7Cgl9CgoJLy8gQmluZCB0aGUgc29ja2V0IHRvIHRoZSBuZXR3b3JrIG9wdF9j
YW5kZXYKCWFkZHIuY2FuX2ZhbWlseSA9IEFGX0NBTjsKCWFkZHIuY2FuX2lmaW5kZXggPSBpZnIu
aWZyX2lmaW5kZXg7CglyYyA9IGJpbmQoc29ja2ZkW2RldmlkeF0sIChzdHJ1Y3Qgc29ja2FkZHIg
KikmYWRkciwgc2l6ZW9mKGFkZHIpKTsKCWlmICgtMSA9PSByYykgewoJICAgIHBlcnJvcigiYmlu
ZCIpOwoJICAgIGV4aXQoY2xlYW51cCgxKSk7Cgl9CgoJZXJyX21hc2sgID0gIENBTl9FUlJfTUFT
SzsgLyogYWxsICovCgllcnJfbWFzayAmPSB+Q0FOX0VSUl9MT1NUQVJCOwoJaWYoIHNldHNvY2tv
cHQoc29ja2ZkW2RldmlkeF0sIFNPTF9DQU5fUkFXLCBDQU5fUkFXX0VSUl9GSUxURVIsCgkJICAg
ICAgICZlcnJfbWFzaywgc2l6ZW9mKGVycl9tYXNrKSkgPCAwICkgCgl7CgkgICAgZXJyb3IoIlxu
RXJyb3IgaW4gc2V0c29ja29wdCAiKTsKCSAgICBleGl0KGNsZWFudXAoMSkpOwoJfQoKCS8qIENo
ZWNrIGlmIHdlIGhhdmUgRkQgY2FwYWJsZSBpbnRlcmZhY2UgKi8KCWlmKCBpb2N0bChzb2NrZmRb
ZGV2aWR4XSwgU0lPQ0dJRk1UVSwgJmlmcikgPCAwICkgewoJCWVycm9yKCJcbkVycm9yIGluIFNJ
T0NHSUZNVFUgIik7CgkJZXhpdChjbGVhbnVwKDEpKTsKCX0KCWNhbl9tdHVbZGV2aWR4XSA9IGlm
ci5pZnJfbXR1OwoKCS8qIFRyeSB0byBzd2l0Y2ggdGhlIHNvY2tldCBpbnRvIENBTiBGRCBtb2Rl
LgoJICAgVGhpcyB3YXMgbmVlZGVkIGZvciBrY2FuIHdpdGggImZkIG9mZiIgdG8gYmUgYWJsZSB0
bwoJICAgcmVjZWl2ZSBmcmFtZXMgc2VudCBmb3IgYSBrY2FuIHdpdGggImZkIG9uIi4gKi8KCWVu
YWJsZV9jYW5mZCA9IDE7CglzZXRzb2Nrb3B0KHNvY2tmZFtkZXZpZHhdLCBTT0xfQ0FOX1JBVywg
Q0FOX1JBV19GRF9GUkFNRVMsCgkJICAgJmVuYWJsZV9jYW5mZCwgc2l6ZW9mKGVuYWJsZV9jYW5m
ZCkpOwogICAgfQoKICAgIGlmKCAoY2FuX210dVswXSA9PSBDQU5GRF9NVFUpICYmIChjYW5fbXR1
WzFdID09IENBTkZEX01UVSkgKXsKCS8qIE9ubHkgaWYgYm90aCBzdXBwb3J0IEZEICovCgljbXBf
bXR1ID0gQ0FORkRfTVRVOwoJICAgIAoJaWYoIG9wdF9kbGVuID09IC0xICl7CgkgICAgb3B0X2Rs
ZW4gPSA2NDsKCX0KCWlmKCBvcHRfZGxlbiA+IDY0ICl7CgkgICAgZnByaW50ZihzdGRlcnIsICJc
bkVycm9yOiBkbGVuIGRvZXMgbm90IGZpdCBpbnRvIE1UVVxuIik7CgkgICAgZXhpdChjbGVhbnVw
KDEpKTsKCX0KICAgIH0gZWxzZSB7CgljbXBfbXR1ID0gQ0FOX01UVTsKCglpZiggb3B0X2RsZW4g
PT0gLTEgKXsKCSAgICBvcHRfZGxlbiA9IDg7Cgl9CglpZiggb3B0X2RsZW4gPiA4ICl7CgkgICAg
ZnByaW50ZihzdGRlcnIsICJcbkVycm9yOiBkbGVuIGRvZXMgbm90IGZpdCBpbnRvIE1UVSAobm8g
RkQgc3VwcG9ydClcbiIpOwoJICAgIGV4aXQoY2xlYW51cCgxKSk7Cgl9CglpZiggb3B0X2JycyAp
ewoJICAgIGZwcmludGYoc3RkZXJyLCAiXG5FcnJvcjogbm9uLUZEIGRvZXMgbm90IHN1cHBvcnQg
Yml0IHJhdGUgc3dpdGNoXG4iKTsKCSAgICBleGl0KGNsZWFudXAoMSkpOwoJfQogICAgfQogICAg
CiAgICB2cHJpbnRmKFZFUkJfSUZQUk9QLCAiIE1UVT0lZC8lZCAiLCBjYW5fbXR1WzBdLCBjYW5f
bXR1WzFdKTsKCgogICAgaWYoIG9wdF9zZW5kICl7CglzdHJ1Y3QgY2FuZmRfZnJhbWUgIHR4ZnJh
bWU7CglpbnQgICAgICAgICAgICAgICAgIHR4ZGF0YTsKCWludCAgICAgICAgICAgICAgICAgdHhm
YWlsPTA7CglpZiggc3NjYW5mKG9wdF9zZW5kLCAiJXgiLCAmdHhkYXRhKSA9PSAxICl7CgkgICAg
dHhmcmFtZS5jYW5faWQgPSAwOwoJICAgIHR4ZnJhbWUuZmxhZ3MgPSAwOwoJICAgIHR4ZnJhbWUu
bGVuID0gODsKCSAgICBmb3IoaT0wOyBpPDg7IGkrKyl7CgkJdHhmcmFtZS5kYXRhW2ldID0gdHhk
YXRhOwoJICAgIH0KCSAgICBwcmludGYoInR4MCAiKTsKCSAgICBpZiggd3JpdGUoc29ja2ZkWzBd
LCAodm9pZCAqKSZ0eGZyYW1lLCBjYW5fbXR1WzBdKSA8IGNhbl9tdHVbMF0gKXsKCQlmcHJpbnRm
KHN0ZGVyciwgIm9wdF9zZW5kOiBzZW5kIGVycm9yIGNhbngtbmV0aWZcbiIpOwoJCXR4ZmFpbCA9
IDE7CgkgICAgfQoJICAgIHR4ZnJhbWUuY2FuX2lkID0gMTsKCSAgICBwcmludGYoInR4MSAiKTsK
CSAgICBpZiggd3JpdGUoc29ja2ZkWzFdLCAodm9pZCAqKSZ0eGZyYW1lLCBjYW5fbXR1WzFdKSA8
IGNhbl9tdHVbMV0gKXsKCQlmcHJpbnRmKHN0ZGVyciwgIm9wdF9zZW5kOiBzZW5kIGVycm9yIGNh
bnktbmV0aWZcbiIpOwoJCXR4ZmFpbCA9IDE7CgkgICAgfQoJICAgIC8qIHdhaXQgdW50aWxzIG1z
Z3MgYXJlIHNlbmRlZCAqLwoJICAgIHVzbGVlcCgxMCoxMDAwKTsKCX0gZWxzZSB7CgkgICAgZnBy
aW50ZihzdGRlcnIsICJvcHRfc2VuZDogd3JvbmcgcGFyYW1ldGVyXG4iKTsKCSAgICB0eGZhaWwg
PSAxOwoJfQoKCWlmKCB0eGZhaWwgKXsKCSAgICBwcmludGYoImZhaWxcbiIpOwoJfSBlbHNlIHsK
CSAgICBwcmludGYoIm9rXG4iKTsKCX0KCWV4aXQoY2xlYW51cCh0eGZhaWwpKTsKICAgIH0KICAg
IAogICAgaWYoIG9wdF9ydCApewoJLyogRGVjbGFyZSBvdXJzZWxmIGFzIGEgcmVhbCB0aW1lIHRh
c2sgKi8KCXBhcmFtLnNjaGVkX3ByaW9yaXR5ID0gb3B0X3J0OwoJaWYoc2NoZWRfc2V0c2NoZWR1
bGVyKDAsIFNDSEVEX0ZJRk8sICZwYXJhbSkgPT0gLTEpIHsKCSAgICBwZXJyb3IoIlxuRVJST1I6
IHNjaGVkX3NldHNjaGVkdWxlciBmYWlsZWQiKTsKCSAgICBleGl0KGNsZWFudXAoMikpOwoJfQoJ
CgkvKiBMb2NrIG1lbW9yeSAqLwoJaWYobWxvY2thbGwoTUNMX0NVUlJFTlR8TUNMX0ZVVFVSRSkg
PT0gLTEpIHsKCSAgICBwZXJyb3IoIlxuRVJST1I6IG1sb2NrYWxsIGZhaWxlZCIpOwoJICAgIGV4
aXQoY2xlYW51cCgyKSk7Cgl9CiAgICB9CgogICAgcmFuZG9tX2RsY19pbml0KG9wdF9kbGVuKTsK
CiAgICAvKiBDcmVhdGUgb3VyIHRyYW5zbWlzc2lvbiBwYWNrZXRzLgogICAgICAgYnl0ZXMgMC4u
MSA6IHNlcXVlbmNlIG51bWJlcgogICAgICAgcmVzdCAgICAgICA6IHJhbmRvbSBkYXRhICovCiAg
ICB0aW1lKCZ0KTsKICAgIHNyYW5kKCh1bnNpZ25lZCBpbnQpdCk7CiAgICBmb3IodHhjbnQ9MDsg
dHhjbnQ8TUFYUEtUTlVNOyB0eGNudCsrKXsKCWZvcihkZXZpZHg9MDsgZGV2aWR4PDI7IGRldmlk
eCsrKXsKCSAgICB0eGRhdGFbZGV2aWR4XVt0eGNudF0uY2FuX2lkICA9IChvcHRfaWQrZGV2aWR4
KTsKCSAgICBpZiggb3B0X2VmZiApewoJCXR4ZGF0YVtkZXZpZHhdW3R4Y250XS5jYW5faWQgfD0g
Q0FOX0VGRl9GTEFHOwoJICAgIH0KCSAgICB0eGRhdGFbZGV2aWR4XVt0eGNudF0uZmxhZ3MgPSAw
OwoJICAgIGlmKCBvcHRfYnJzICl7CgkJdHhkYXRhW2RldmlkeF1bdHhjbnRdLmZsYWdzIHw9IENB
TkZEX0JSUzsKCSAgICB9CgkgICAgdHhkYXRhW2RldmlkeF1bdHhjbnRdLmxlbiA9IG9wdF9kbGVu
OwoJICAgIGlmKCBvcHRfZmxhZ3MgJiBGTEFHU19SQU5ET01JWkUgKXsKCQl0eGRhdGFbZGV2aWR4
XVt0eGNudF0ubGVuID0gcmFuZG9tX2RsYygpOwoJICAgIH0KCSAgICB0eGRhdGFbZGV2aWR4XVt0
eGNudF0uZGF0YVswXSA9ICh0eGNudD4+IDgpJjB4ZmY7CgkgICAgdHhkYXRhW2RldmlkeF1bdHhj
bnRdLmRhdGFbMV0gPSAodHhjbnQ+PiAwKSYweGZmOwoJICAgIGZvcihpPTI7IGk8b3B0X2RsZW47
IGkrKyl7CgkJaWYoIG9wdF9mbGFncyAmIEZMQUdTX05PUkFORE9NREFUQSApewoJCSAgICB0eGRh
dGFbZGV2aWR4XVt0eGNudF0uZGF0YVtpXSA9IHR4Y250ICYgMHhmZjsKCQl9IGVsc2UgewoJCSAg
ICB0eGRhdGFbZGV2aWR4XVt0eGNudF0uZGF0YVtpXSA9IHJhbmQoKSAmIDB4ZmY7CgkJfQoJICAg
IH0KCX0KICAgIH0KICAgIAogICAgZmZsdXNoKHN0ZG91dCk7CgogICAgLyogUnVuIHJlcXVlc3Rl
ZCBsb29wcyBvZiB0ZXN0ICovCiAgICBmb3IobG9vcD0wOyBsb29wPG9wdF9sb29wczsgbG9vcCsr
KXsKCXJjID0gdGVzdGxvb3Aoc29ja2ZkLCBvcHRfcGt0cyk7CglpZiggcmMgPCAwICl7CgkgICAg
cHJpbnRmKCJmYWlsXG4iKTsKCSAgICBleGl0KGNsZWFudXAoMSkpOwoJfQoJaWYoIG9wdF9mbGFn
cyAmIEZMQUdTX0xFQVNURE9UUyApewoJICAgIGlmKCAobG9vcCAlIDEwMCkgPT0gMCApewoJCXBy
aW50ZigiLiIpOwoJICAgIH0KCX0gZWxzZSBpZiggb3B0X2ZsYWdzICYgRkxBR1NfTEVTU0RPVFMg
KXsKCSAgICBpZiggKGxvb3AgJSAxMCkgPT0gMCApewoJCXByaW50ZigiLiIpOwoJICAgIH0KCX0g
ZWxzZSB7CgkgICAgcHJpbnRmKCIuIik7Cgl9CglmZmx1c2goc3Rkb3V0KTsKCglpZiggY2FudGVz
dF9yYXcuc3RhdHVzID09IENUX1JBV19URVJNSU5BVEVEICl7CgkgICAgaWYoICEgc2lnaW50ICl7
CgkJcHJpbnRmKCIgKHRlcm1pbmF0ZWQpIG9rXG4iKTsKCQlmZmx1c2goc3Rkb3V0KTsKCSAgICB9
CgkgICAgZXhpdChjbGVhbnVwKDApKTsKCX0KCQoJaWYoIGNhbnRlc3RfcmF3LnN0YXR1cyAhPSAw
ICl7CgkgICAgaWYoIChjYW50ZXN0X3Jhdy5zdGF0dXMgPT0gQ1RfUkFXX0JBRF9PUkRFUikKCQkm
JiAob3B0X2ZsYWdzICYgRkxBR1NfQUxMT1dPT09EKSApCgkgICAgewoJCS8qIGFsbG93ZWQgKi8K
CSAgICB9IGVsc2UgeyAKCQlpZiggKGNhbnRlc3RfcmF3LnN0YXR1cyA9PSBDVF9SQVdfQkFEX1JF
Q0VJVkUpCgkJICAgIHx8IChjYW50ZXN0X3Jhdy5zdGF0dXMgPT0gQ1RfUkFXX0JBRF9PUkRFUikK
CQkgICAgfHwgKGNhbnRlc3RfcmF3LnN0YXR1cyA9PSBDVF9SQVdfRFVQTElDQVRFUykgKQoJCXsK
CQkgICAgcHJpbnRmKCJjICglZCkgZmFpbFxuIiwgbG9vcCk7CgkJfSBlbHNlIGlmKCBjYW50ZXN0
X3Jhdy5zdGF0dXMgPT0gQ1RfUkFXX1RJTUVPVVQgKXsKCQkgICAgcHJpbnRmKCJ0ICglZCkgZmFp
bFxuIiwgbG9vcCk7CgkJfSBlbHNlIGlmKCBjYW50ZXN0X3Jhdy5zdGF0dXMgPT0gQ1RfUkFXX05P
X1JFU1BPTlNFKXsKCQkgICAgcHJpbnRmKCJUICglZCkgZmFpbFxuIiwgbG9vcCk7CgkJfSBlbHNl
IGlmKCBjYW50ZXN0X3Jhdy5zdGF0dXMgPT0gQ1RfUkFXX0JVU19FUlJPUlMpewoJCSAgICBwcmlu
dGYoImIgKCVkKSBmYWlsXG4iLCBsb29wKTsKCQl9IGVsc2UgaWYoIGNhbnRlc3RfcmF3LnN0YXR1
cyA9PSBDVF9SQVdfUkVBRF9FUlJPUil7CgkJICAgIHByaW50ZigiciAoJWQpIGZhaWxcbiIsIGxv
b3ApOwoJCX0gZWxzZSB7CgkJICAgIHByaW50ZigiPyVkICglZCkgZmFpbFxuIiwgY2FudGVzdF9y
YXcuc3RhdHVzLCBsb29wKTsKCQl9CgkJaWYoIG9wdF92ZXJib3NlICYgVkVSQl9MT0dNU0cgKXsK
CQkgICAgZGJnX2xvZ19wcmludCgpOwoJCX0KCQlpZiggb3B0X2xvZ2dlciApewoJCSAgICByZWFk
TG9nZ2VyKG9wdF9sb2dnZXIsIG9wdF9wa3RzKjIrMjApOwoJCX0KCQlpZiggb3B0X2ZsYWdzICYg
RkxBR1NfU1RPUE9ORVJST1IgKXsKCQkgICAgcHJpbnRmKCJTdG9wcGVkLiBDdHJsLUMgdG8gZXhp
dC5cbiIpOwoJCSAgICBmZmx1c2goc3Rkb3V0KTsKCQkgICAgd2hpbGUoIDEgKXsKCQkJc2xlZXAo
MSk7CgkJICAgIH0KCQl9CgkJZXhpdChjbGVhbnVwKDEpKTsKCSAgICB9Cgl9CgkKCWlmKCBvcHRf
bGRlbGF5ICl7CgkgICAgdXNsZWVwKG9wdF9sZGVsYXkqMTAwMCk7Cgl9CgoJaWYoIG9wdF9mbGFn
cyAmIEZMQUdTX1JFRklMTERBVEEgKXsKCSAgICBmb3IoZGV2aWR4PTA7IGRldmlkeDwyOyBkZXZp
ZHgrKyl7CgkJZm9yKHR4Y250PTA7IHR4Y250PG9wdF9wa3RzOyB0eGNudCsrKXsKCQkgICAgbiA9
IHR4ZGF0YVtkZXZpZHhdW3R4Y250XS5sZW47CgkJICAgIGZvcihpPTI7IGk8bjsgaSsrKXsKCQkJ
dHhkYXRhW2RldmlkeF1bdHhjbnRdLmRhdGFbaV0gPSByYW5kKCkgJiAweGZmOwoJCSAgICB9CgkJ
fQoJICAgIH0KCX0KICAgIAogICAgfQogICAgCiAgICBwcmludGYoIiBva1xuIik7CiAgICByZXR1
cm4gY2xlYW51cCgwKTsKfQo=

--_002_FR0P281MB1966F32AD422DDD867F8C53A97C79FR0P281MB1966DEUP_--
